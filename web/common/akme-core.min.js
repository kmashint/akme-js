// akme-core
(function(c){var a=function(){},e=Array.prototype,d=Array.prototype.slice;if(typeof console==="undefined"){console={log:a,debug:a,info:a,warn:a,error:a,assert:a};}if(typeof console.logEnabled==="undefined"){console.logEnabled=false;}if(!Function.prototype.getShortName){Function.prototype.getShortName=function(g){var f=String(g?g.name:this.name);if(f){return f.substring(f.lastIndexOf(".")+1);}else{return;}};}if(!Function.prototype.bind){Function.prototype.bind=function(i){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}var k=Array.prototype.slice,h=k.call(arguments,1),g=this,f=function(){},j=function(){return g.apply(this instanceof f?this:i||window,h.concat(k.call(arguments)));};f.prototype=this.prototype;j.prototype=new f();return j;};}if(!Object.values){Object.values=function(j){var g=[],f=Object.keys(j);for(var h=0;h<f.length;h++){g.push(j[f[h]]);}return g;};}if(!Array.binarySearch){Array.binarySearch=function(h,j){var g=0,i=h.length,f=0;while(g<=i){if(j>h[(f=Math.floor((g+i)/2))]){g=f+1;}else{i=(j==h[f])?-2:f-1;}}return(i==-2)?f:-1;};}for(var b in {indexOf:1,lastIndexOf:1,every:1,filter:1,forEach:1,map:1,some:1,reduce:1,reduceRight:1}){(function(f){if(!Array[f]){Array[f]=function(g){return e[f].apply(g,d.call(arguments,1));};}})(b);}})(this);if(!this.akme){this.akme={THIS:this,WHITESPACE_TRIM_REGEXP:/^\s*|\s*$/gm,PRINTABLE_EXCLUDE_REGEXP:/[^\x20-\x7e\xc0-\xff]/g,MILLIS_IN_HOUR:60*60000,MILLIS_IN_DAY:24*60*60000,noop:function(){},slice:Array.prototype.slice,isDefinedNotNull:function(a){return typeof a!=="undefined"&&a!==null;},isArray:Array.isArray||function(a){return a instanceof Array;},isBoolean:function(a){return typeof a==="boolean"||a instanceof Boolean;},isDate:function(a){return a instanceof Date;},isFunction:function(a){return typeof a==="function";},isNumber:function(a){return typeof a==="number"||a instanceof Number;},isString:function(a){return typeof a==="string"||a instanceof String;},concat:function(d){for(var a=1;a<arguments.length;a++){var c=arguments[a];for(var b=0;b<c.length;b++){d[d.length]=(c[b]);}}return d;},deleteAll:function(b){if(b instanceof Array){b.length=0;}else{for(var a in b){if(b.hasOwnProperty(a)){delete b[a];}}}},clone:function(b){if(b===undefined||b===null){return b;}if(typeof b.clone==="function"){return b.clone();}var c=Object.create(Object.getPrototypeOf(b));for(var a in b){if(b.hasOwnProperty(a)){c[a]=b[a];}}return c;},copy:function(d,c,b){if(c===undefined||c===null){return d;}b=!!b;for(var a in c){if(b||c.hasOwnProperty(a)){d[a]=c[a];}}return d;},copyAll:function(b,a){return this.copy(b,a,true);},copyExisting:function(e,d,b,c){if(d===undefined||d===null){return e;}b=!!b;c=!!c;for(var a in d){if(((a in e)!==c)&&(b||d.hasOwnProperty(a))){e[a]=d[a];}}return e;},copyAllExisting:function(b,a){return this.copyExisting(b,a,true);},copyMissing:function(b,a){return this.copyExisting(b,a,false,true);},copyAllMissing:function(b,a){return this.copyExisting(b,a,true,true);},copyArrayToObject:function(e,b,c,d){if(typeof d!="undefined"){for(var a=0;a<b.length;a++){e[b[a][c]]=b[a][d];}}else{for(var a=0;a<b.length;a++){e[b[a][c]]=b[a];}}return e;},copyArray:function(f,c,b){var e,a=f.length||0,d=new Array(a);if(typeof c==="function"){for(e=0;e<a;e++){d[e]=c.call(b,f[e],e,f);}}else{for(e=0;e<a;e++){d[e]=f[e];}}return d;},concatMapKeys:function(b,c){for(var a in c){b[b.length]=a;}return b;},getMapKeys:function(a){return this.concatMapKeys([],a);},getProperty:function(d,c,b){if(typeof c==="string"||c instanceof String){c=c.split(".");}var f=d;var e=c.length;for(var a=0;a<e;a++){if(c[a] in f){f=f[c[a]];}else{return b;}}return f;},setProperty:function(c,b,d){if(typeof b==="string"||b instanceof String){b=b.split(".");}var f=c;var e=b.length-1;for(var a=0;a<e;a++){if(b[a] in f){f=f[b[a]];}else{f=f[b[a]]={};}}f[b[e]]=d;return f;},extendClass:function(a,b){if(b){if(typeof b==="function"){a.prototype=Object.create(b.prototype);}else{a.prototype=b;}}a.constructor=a.prototype.constructor;a.prototype.constructor=a;return a;},extendDestroy:function(b,a){this.extendFunction(b,"destroy",a,true);},extendFunction:function(c,b,e,d){var a=c[b];if(a){if(d){c[b]=function(){e.apply(this,arguments);a.apply(this,arguments);};}else{c[b]=function(){a.apply(this,arguments);e.apply(this,arguments);};}}else{c[b]=e;}},newApplyArgs:function(d,b){if(!b||b.length===0){return new d();}switch(b.length){case 1:return new d(b[0]);case 2:return new d(b[0],b[1]);case 3:return new d(b[0],b[1],b[2]);case 4:return new d(b[0],b[1],b[2],b[3]);case 5:return new d(b[0],b[1],b[2],b[3],b[4]);default:var a=new Array(b.length);for(var c=0;c<b.length;c++){a[c]="a["+c+"]";}return(new Function("f","a","return new f("+a.join(",")+");"))(d,b);}},handleEvent:function(b){if(!b){return;}var a=this.slice.call(arguments,1);if(typeof b==="function"){b.apply(undefined,a);}else{b.handleEvent.apply(b,a);}},fixHandleEvent:function(b){if(document.documentMode&&document.documentMode<9&&typeof b.handleEvent==="function"&&!b.handleEvent._ie8fix){var a=b.handleEvent;b.handleEvent=function(c){a.call(b,c);};b.handleEvent._ie8fix=function(){return a;};}return b;},trim:function(a){return a.replace(this.WHITESPACE_TRIM_REGEXP,"");},limitLengthWithDots:function(b,a){b=String(b);return b.length>a?b.substring(0,a-3)+"...":b;},padLeft:function(f,c,e){var d=String(f);if(d.length>=c){return d;}if(d.length+1==c){return e+d;}var b=new Array(1+(c>d.length?c-d.length:0));b[b.length-1]=d;return b.join(e?e:" ");},round2:function(a){return Math.round(a*100+0.5)/100;},round3:function(a){return Math.round(a*1000+0.5)/1000;},round:function(b,a){return Math.round(b/a+0.5)*a;},setValidDateTimeInt:function(e,a){var c=Math.floor(a/1000000);var b=(a%1000000);return this.setValidDateTime(e,Math.floor(c/10000),Math.floor(c/100)%100,c%100,Math.floor(b/10000),Math.floor(b/100)%100,b%100);},setValidDateTime:function(d,e,c,i,h,f,g,a){var b=new Date(e,parseInt(c||1,10)-1,parseInt(i||1,10),parseInt(h||0,10),parseInt(f||0,10),parseInt(g||0,10),parseInt(a||0,10));if(b.getFullYear()!=e||b.getMonth()+1!=c||b.getDate()!=i){b=d;}else{if(arguments.length>=5&&(b.getHours()!=h||b.getMinutes()!=f||b.getSeconds()!=g)){b=d;}else{if(arguments.length>=8&&b.getMilliseconds()!=a){b=d;}}}return b;},parseDate:function(a){var c=a.match(/([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?/);var b=new Date(c[1],parseInt(c[3]||1,10)-1,parseInt(c[5]||1,10),parseInt(c[7]||0,10),parseInt(c[8]||0,10),parseInt(c[10]||0,10),c[12]?Number("0."+c[12])*1000:0);return b;},formatIsoDate:function(a){return a.getFullYear()+"-"+this.padLeft(a.getMonth()+1,2,"0")+"-"+this.padLeft(a.getDate(),2,"0");},formatIsoDateTime:function(c,b){if(!b){b="T";}var a=(c.getFullYear()*10000+(c.getMonth()+1)*100+c.getDate())*1000000+c.getHours()*10000+c.getMinutes()*100+c.getSeconds();return String(a).replace(/^(....)(..)(..)(..)(..)(..)/,"$1-$2-$3"+b+"$4:$5:$6."+String(c.getMilliseconds()+1000).substring(1));},diffDays:function(a,b){if(a instanceof Date){a=a.getTime();}if(b instanceof Date){b=b.getTime();}return Math.floor((b-a+12*this.MILLIS_IN_HOUR)/this.MILLIS_IN_DAY);},getYearDayByIsoMonday:function(c){var a=3-(c.getDay()+6)%7;var e=new Date(c.getTime());e.setDate(e.getDate()+a);var d=e.getFullYear();var b=Math.round((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/this.MILLIS_IN_DAY-1)/7;return d*1000+b*7+3-a;},getDateByIsoMonday:function(b,c){b=Math.floor(b);c=Math.floor(c);var a=new Date(b,1-1,4);a.setDate(a.getDate()-(a.getDay()+6)%7+(c-1));return a;}};}(function(c,b){if(c.getProperty(c.THIS,b)){return;}function d(){}c.extendClass(c.copyAll(d,{CLASS:b}),{clear:null,flush:null,sync:null,syncDecorator:null,find:null,findOne:null,findDecorator:null,read:null,readDecorator:null,readMany:a,write:null,remove:null});c.setProperty(c.THIS,b,d);function a(h){var e=[];if(typeof h==="undefined"||h===null){return e;}if(typeof h==="function"){e[e.length]=this.read(h());}else{if(h instanceof Array){for(var g=0;g<h.length;g++){e[e.length]=this.read(h[g]);}}else{if(h instanceof Object){for(var f in h){e[e.length]=this.read(f);}}else{e[e.length]=this.read(h);}}}return e;}})(akme,"akme.core.Access");(function(c,b){if(c.getProperty(c.THIS,b)){return;}function a(){}c.copyAll(a,{CLASS:b});c.copyAll(a.prototype,{toString:d});c.setProperty(c.THIS,b,a);function d(){return this.constructor.CLASS+c.formatJSON(this);}})(akme,"akme.core.Data");(function(e,b){if(e.getProperty(e.THIS,b)){return;}var g={};function f(){var s={map:{},ary:[]};this.PRIVATES=function(t){return t===g?s:undefined;};this.length=s.ary.length;}e.extendClass(e.copyAll(f,{CLASS:b}),{size:k,linkMapTo:a,keys:j,key:r,keySlice:o,value:n,values:c,valueSlice:l,get:p,set:i,remove:q,clear:m,copyFrom:d,copyAllFrom:h});e.setProperty(e.THIS,b,f);function a(t,s){t[s]=this.PRIVATES(g).map;return this;}function k(){return this.PRIVATES(g).ary.length;}function j(){return this.PRIVATES(g).ary.slice(0);}function r(s){return this.PRIVATES(g).ary[s];}function o(t,s){return s?this.PRIVATES(g).ary.slice(t,s):this.PRIVATES(g).ary.slice(t);}function n(s){var t=this.PRIVATES(g);return t.map[t.ary[s]];}function c(){var u=this.PRIVATES(g);var t=new Array(u.ary.length);for(var s=0;s<u.ary.length;s++){t[s]=u.map[u.ary[s]];}return t;}function l(w,s){var v=this.PRIVATES(g);if(!(s>=0)){s=v.ary.length;}var u=new Array(s-w);for(var t=w;t<s;t++){u[t-w]=v.map[v.ary[t]];}return u;}function p(s){return this.PRIVATES(g).map[s];}function i(s,u){var t=this.PRIVATES(g);if(!(s in t.map)){t.ary[t.ary.length]=s;this.length=t.ary.length;}t.map[s]=u;}function q(t){var u=this.PRIVATES(g);if(!(t in u.map)){return;}for(var s=0;s<u.ary.length;s++){if(u.ary[s]===t){u.ary.splice(s,1);this.length=u.ary.length;break;}}delete u.map[t];}function m(){var t=this.PRIVATES(g);t.ary.splice(0,t.ary.length);this.length=0;for(var s in t.map){delete t.map[s];}}function d(w,v,x){var s=typeof x!=="undefined";if(w instanceof Array||typeof w.length==="number"){for(var u=0;u<w.length;u++){this.set(w[u][v],s?w[u][x]:w[u]);}}else{for(var t in w){if(w.hasOwnProperty(t)){this.set(w[t][v],s?w[t][x]:w[t]);}}}return this;}function h(v,u,w){var s=typeof w!=="undefined";for(var t in v){this.set(v[t][u],s?v[t][w]:v[t]);}return this;}})(akme,"akme.core.IndexedMap");(function(c,a){if(c.getProperty(c.THIS,a)){return;}var i={},b="\u001f",z=Array.prototype;function g(B,F,G,k){if(F.key.length===1){var D=F.key[0];if(c.isNumber(D)){B.keyMap[G[D]]=k;}else{B.keyMap[G[F.map[D]]]=k;}}else{var E=new Array(F.key.length);for(var C=0;C<E.length;C++){E[C]=G[c.isNumber(F.key[C])?F.key[C]:F.map[F.key[C]]];}B.keyMap[E.join(b)]=k;}}function w(k){return function(){return z[k].apply(this.PRIVATES(i).body,arguments);};}function t(){var k={idx:-1,key:[],map:{},head:[],body:[],rowMap:null};this.PRIVATES=function(B){return B===i?k:undefined;};this.length=k.body.length;this.width=k.head.length;this.keyMap={};}c.extendClass(c.copyAll(t,{CLASS:a,KEY_SEP:b}),{head:d,key:A,meta:p,clearBody:h,push:f,body:l,bodyObjects:m,headIndex:n,rowIndexByKey:o,rowIndex:j,rowByKey:y,row:e,value:u,fromJSON:s,toJSON:x,join:r,select:w("filter"),mapBy:q});for(var v in {concat:1,every:1,filter:1,forEach:1,indexOf:1,lastIndexOf:1,map:1,reduce:1,reduceRight:1,slice:1,some:1}){t.prototype[v]=w(v);}c.setProperty(c.THIS,a,t);function r(){var C=this.PRIVATES(i);if(arguments.length>1){var k=new Array(C.body.length);for(var B=0;B<k.length;B++){k[B]=C.body[B].join(arguments[1]);}return k.join(arguments[0]);}else{return z.join.apply(C.body,arguments);}}function d(C){if(arguments.length>1){C=z.slice.call(arguments,0);}var D=this.PRIVATES(i);D.head.length=0;c.deleteAll(D.map);if(C instanceof Array){for(var B=0;B<C.length;B++){D.map[C[B]]=B;}}else{c.copy(D.map,C);}this.width=D.head.length;if(!c.isIE8){D.rowMap={};}for(var k in D.map){D.head[D.map[k]]=k;if(D.rowMap){D.rowMap[k]=(function(E){return{get:function(){return this[D.map[E]];},set:function(F){this[D.map[E]]=F;}};})(k);}}}function A(k){var C=this.PRIVATES(i);if(!(k instanceof Array)){k=[k||0];}C.key.length=k.length;for(var B=0;B<C.key.length;B++){C.key[B]=k[B];}}function p(){var k=this.PRIVATES(i);return{key:k.key.slice(0),head:k.head.slice(0),headLength:k.head.length,bodyLength:k.body.length};}function h(){var k=this.PRIVATES(i);this.length=k.body.length=0;c.deleteAll(this.keyMap);}function f(k){this.body([k]);}function l(B,E){var C=this.PRIVATES(i);for(var k=0;k<B.length;k++){var D=B[k];if(E){E=false;this.head(D);continue;}if(C.rowMap){Object.defineProperties(D,C.rowMap);}C.body.push(D);g(this,C,D,C.body.length-1);}this.length=C.body.length;}function m(H){var F=this.PRIVATES(i);for(var C=0,k=0;C<H.length;C++){var E=H[C];if(F.head.length===0){var D={};for(var B in E){D[B]=k++;}this.head(D);}var G=new Array(F.head.length);if(F.rowMap){Object.defineProperties(G,F.rowMap);}for(k=0;k<G.length;k++){G[k]=E[F.head[k]];}F.body.push(G);g(this,F,G,F.body.length-1);}this.length=F.body.length;}function n(B){var k=this.PRIVATES(i).map[B];return k>=0?k:-1;}function j(k){var B=this.PRIVATES(i);if(!(k>=0)){return this.PRIVATES(i).idx;}if(c.isNumber(k)&&k>=0||k<B.body.length){B.idx=k;}else{B.idx=-1;}}function o(B){var k=this.keyMap[arguments.length>1?z.slice.call(arguments,0).join(b):(B instanceof Array?B.join(b):B)];return k>=0?k:-1;}function y(){return this.row(this.rowIndexByKey.apply(this,arguments));}function e(k){var B=this.PRIVATES(i);return B.body[typeof k!=="undefined"?k:B.idx];}function u(){var B=this.PRIVATES(i);var C=arguments[0],k=arguments[1];if(arguments.length===1){k=C;C=B.idx;}return B.body[C][typeof k==="number"?k:this.headIndex(name)];}function q(B){var C={},k=arguments.length>=2?arguments[1]:undefined;this.forEach(function(G,D){var F=B.call(k,G,D,this),E;if(F!=null){E=C[F]||[];E[E.length]=G;if(E.length===1){C[F]=E;}}});return C;}function s(k){var B=c.isString(k)?c.parseJSON(k):k;this.head(B.head);this.key(B.key);this.clearBody();this.body(B.body);}function x(){var k=this.PRIVATES(i);return c.formatJSON({key:k.key,head:k.head,body:k.body});}})(akme,"akme.core.DataTable");(function(e,d){if(e.getProperty(e.THIS,d)){return;}var b={};function h(){if(this.EVENTS){return;}if(console.logEnabled){console.log(this.constructor.CLASS+" injecting "+d+" arguments.length "+arguments.length);}var i={eventMap:{}};this.EVENTS=function(j){return j===b?i:undefined;};this.onEvent=g;this.unEvent=a;this.doEvent=f;e.extendDestroy(this,c);}e.extendClass(Object,e.copyAll(h,{CLASS:d}));e.setProperty(e.THIS,d,h);function c(){if(console.logEnabled){console.log(this.constructor.CLASS+".destroy() "+d);}var j=this.EVENTS(b);for(var i in j.eventMap){delete j.eventMap[i];}}function g(l,n,k){if(!(typeof n==="function"||typeof n.handleEvent==="function")){throw new TypeError(this.constructor.CLASS+".onEvent given neither function(ev){...} nor { handleEvent:function(ev){...} }");}var m=this.EVENTS(b),i=m.eventMap[l];if(!i){i=[];m.eventMap[l]=i;}var j=e.fixHandleEvent(n);i.push({handler:j,once:!!k});}function a(l,n){var m=this.EVENTS(b);var j=m.eventMap[l];if(!j){return;}for(var k=0;k<j.length;k++){if(j[k].handler===n){j.splice(k,1);}}}function f(l){var m=this.EVENTS(b);var j=m.eventMap[l.type];if(j){for(var k=0;k<j.length;k++){var n=j[k];if(typeof n.handler==="function"){n.handler.call(undefined,l);}else{n.handler.handleEvent.call(n.handler,l);}if(n.once){j.splice(k--,1);}}}}})(akme,"akme.core.EventSource");(function(b,h){if(b.getProperty(b.THIS,h)){return;}b.setProperty(b.THIS,h,e);var d={},g=akme;function e(n){if(!(this instanceof e)){return new e(n);}var l={state:0,self:this,args:null,callbackAry:[[],[],[]]};this.PRIVATES=function(o){return o===d?l:undefined;};try{n.call(l.self,j,k);}catch(m){i(m);}function j(){switch(l.state){case 0:l.state=1;l.args=arguments;case 1:c(l.callbackAry[l.state],l.self,l.args,true);break;case 2:console.warn(String(new RangeError("cannot resolve after reject")));}}function k(){switch(l.state){case 0:l.state=2;l.args=arguments;case 2:c(l.callbackAry[l.state],l.self,l.args,true);break;case 1:console.warn(String(new RangeError("cannot reject after resolve")));}}}g.copyAll(e,{CLASS:h,fulfill:f,resolve:f,reject:i}).prototype={then:a,"catch":function(j){return this.then(undefined,j);}};function c(m,j,k,n){for(var l=0;l<m.length;l++){if(k){m[l].apply(j,k);}else{m[l].call(j);}}if(!!n){m.length=0;}}function f(){var j=arguments;return new e(function(k,l){k.apply(this,j);});}function i(){var j=arguments;return new e(function(k,l){l.apply(this,j);});}function a(){var m=this.PRIVATES(d),l=arguments;var j=new e(function r(){var s=this,p=arguments;for(var n=0;n<2;n++){(function(t){var u=l[t];if(typeof u==="function"){l[t]=function(){try{var v=u.apply(m.self,arguments);if(typeof v!=="undefined"&&typeof v.then==="function"){v.then.apply(s,p);}else{p[t].apply(s,typeof v!=="undefined"?[v]:arguments);}}catch(w){if(p[1]){p[1](w);}}};}})(n);}});if(m.state===0){for(var k=0,q=Math.min(l.length,m.callbackAry.length);k<q;k++){if(l[k]){m.callbackAry[k===2?0:k+1].push(l[k]);}}}else{var o=l[m.state===0?2:m.state-1];if(o){o.apply(m.self,m.args);}}return j;}})(akme,"akme.core.Promise");(function(i,b){if(i.getProperty(i.THIS,b)){return;}var k={},o,p="akme.getContext";function n(u){var v={parent:i.getContext?i.getContext():null,map:{},count:0,refreshDate:null};this.PRIVATES=function(w){return w===k?v:undefined;};i.core.EventSource.apply(this);var t=this;this.onEvent("refresh",function(w){v.refreshDate=new Date();if(u){i.handleEvent(u,w);}i.setProperty(i.THIS,p,function(){return t;});});this.refresh();}i.extendClass(i.copyAll(n,{CLASS:b,getRoot:h}),{has:c,isFunction:a,getQuiet:m,get:q,set:l,remove:s,refresh:f,destroy:r,getIdCount:e,getIdArray:g,getParent:j,getRefreshDate:d});i.setProperty(i.THIS,b,n);o=new n();function h(){return o;}function f(){this.doEvent({type:"refresh",context:this});}function r(){var u=this.PRIVATES(k),t=u.parent||o;this.doEvent({type:"destroy",context:this});for(var v in u.map){this.remove(v);}if(t){i.setProperty(i.THIS,p,function(){return t;});}}function d(){return this.PRIVATES(k).refreshDate;}function j(){return this.PRIVATES(k).parent;}function a(t){return typeof this.getQuiet(t)==="function";}function c(u){var t=this.PRIVATES(k);return(u in t.map||(t.parent&&t.parent.has(u)));}function m(v){var t=this.PRIVATES(k);var u=t.map[v];if(u===undefined&&t.parent){u=t.parent.get(v);}return u;}function q(u){var t=this.getQuiet(u);if(typeof t==="function"){t=i.newApplyArgs(t,Array.prototype.slice.call(arguments,1));}if(t===undefined){t=null;}this.doEvent({type:"get",context:this,id:u,instance:t});return t;}function l(x,t){var w=this.PRIVATES(k),v=w.map;if(!(x in v)){w.count++;}var u=v[x];v[x]=t;this.doEvent({type:"set",context:this,id:x,instance:t,oldInstance:u});return u;}function s(w){var v=this.PRIVATES(k),u=v.map;if(w in u){v.count--;}var t=u[w];delete u[w];this.doEvent({type:"remove",context:this,id:w,instance:t});return t;}function e(){return this.PRIVATES(k).count;}function g(){var t=[],v=0;for(var u in this.PRIVATES(k).map){t[v++]=u;}return t;}})(akme,"akme.core.Context");(function(f,e){if(f.getProperty(f.THIS,e)){return;}var b={},d=akme.core.Context;function a(g){d.call(this,function(h){if(console.logEnabled){console.log(e+"()");}h.callback=g;c(h);});}f.extendClass(f.copyAll(a,{CLASS:e,getRoot:d.getRoot}),f.copyAll(Object.create(d.prototype),{}));f.setProperty(f.THIS,e,a);function c(g){if(g.callback){f.handleEvent(g.callback,g);}}})(akme,"akme.core.AppContext");(function(a){akme.copyAll(akme,{isIE8:"documentMode" in document&&document.documentMode===8,isW3C:"addEventListener" in window});if(!(akme.isW3C||akme.isIE8)||!window.postMessage||!window.XMLHttpRequest){console.error("This browser is unsupported, it must be MSIE 8 or support HTML 5 with postMessage and XMLHttpRequest.");}function c(){this.xmldoc=new ActiveXObject("Msxml2.DOMDocument");this.xmldoc.async=false;}if(!a.DOMParser){a.DOMParser=c;}var b=a.DOMParser.prototype.parseFromString;a.DOMParser.prototype.parseFromString=function(e,g){if(this.xmldoc){this.xmldoc.loadXML(e);if(this.xmldoc.parseError.errorCode!==0){var d=this.xmldoc.parseError;throw new SyntaxError("DOMParser error "+d.errorCode+" at line "+d.line+" pos "+d.linepos+": "+d.reason);}return this.xmldoc;}else{try{this.xmldoc=b.call(this,e,g);}catch(f){if(!(f instanceof SyntaxError)){throw new SyntaxError(f);}}if(!this.xmldoc||!this.xmldoc.documentElement){throw new SyntaxError("Invalid XML: "+e);}else{if(this.xmldoc.getElementsByTagName("parsererror").length){throw new SyntaxError(this.xmldoc.documentElement.innerHTML);}}return this.xmldoc;}};if(!a.XMLSerializer){a.XMLSerializer=function(){};}if(!a.XMLSerializer.prototype.serializeToString||(document.documentMode&&document.documentMode==9)){a.XMLSerializer.prototype.serializeToString=function(d){return d.xml;};}if(!a.XMLHttpRequest){a.XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0");}catch(d){throw new Error("This browser does not support XMLHttpRequest.");}};}})(this);akme.copyAll(this.akme,{_html5:null,onContent:function(c){var b=this,e=document,d="DOMContentLoaded";if(!f()){if(b.isW3C){e.addEventListener(d,f,false);window.addEventListener("load",f,false);}else{e.attachEvent("onreadystatechange",f);window.attachEvent("onload",f);}}function f(j){if((!j||j.type!=="load")&&!/interactive|complete/.test(e.readyState)){return false;}if(b.isW3C){e.removeEventListener(d,f,false);window.removeEventListener("load",f);a(j);}else{e.detachEvent("onreadystatechange",f);window.detachEvent("onload",f);var g=false,h=document.createElement("div"),i;try{g=window.frameElement===null;}catch(k){}if(h.doScroll&&g&&window.external){i=setInterval(function(){try{h.doScroll();clearInterval(i);a(j);}catch(l){}},50);}else{a(j);}}}function a(g){setTimeout(function(){b.handleEvent(c,{type:d,target:e});});}},onLoad:function(a){this.onEvent(window,"load",a);},onUnload:function(a){this.onEvent(window,"unload",a);},onEvent:function(b,c,a){if("click"===c&&window.Touch&&this.onEventTouch){this.onEventTouch(b,a);}else{if(this.isW3C){b.addEventListener(c,a,false);}else{b.attachEvent("on"+c,typeof a.handleEvent==="function"?this.fixHandleEvent(a).handleEvent:a);}}},unEvent:function(b,c,a){if("click"===c&&window.Touch&&this.unEventTouch){this.unEventTouch(b,a);}else{if(this.isW3C){b.removeEventListener(c,a,false);}else{b.detachEvent("on"+c,typeof a.handleEvent==="function"?a.handleEvent:a);}}},fixHandleEvent:function(b){if(document.documentMode&&document.documentMode<9&&typeof b.handleEvent==="function"&&!b.handleEvent._ie8fix){var a=b.handleEvent;b.handleEvent=function(){a.apply(b,arguments);};b.handleEvent._ie8fix=function(){return a;};}return b;},getEventElement:function(a){return(a.target.nodeType===1)?a.target:a.target.parentNode;},getEventCurrentTarget:function(c,e){if(c.currentTarget){return c.currentTarget;}var b=this.getEventElement(c);if(typeof e=="function"){while(b&&b.nodeType==1){if(e(b)){return b;}b=b.parentNode;}}else{while(b&&b.nodeType==1){var d=true;for(var a in e){if("class"==a){if(!this.hasClass(b,e[a])){d=false;}}else{if(b.getAttribute(a)!=e[a]){d=false;}}}if(d){return b;}b=b.parentNode;}}return b;},cancelEvent:function(a){a.preventDefault();a.stopPropagation();},getBaseHref:function(){var b=document.getElementsByTagName("base");return b.length!==0?b[0].href:"";},getContextPath:function(){var b=document.getElementsByName("head")[0].getElementsByTagName("meta");for(var c=0;c<b.length;c++){if(b[c].name==="contextPath"){return b[c].content?b[c].content:"/.";}}return"/.";},isHtml5:function(){if(this._html5==null){try{var a=document.createElement("video");this._html5=(typeof a.canPlayType!=="undefined"&&a.canPlayType("video/mp4")!="");}catch(b){this._html5=false;}}return this._html5;},parseJSON:function(b,a){return JSON.parse(b,a);},formatJSON:function(b,a){return JSON.stringify(b,a);},parseXML:function(a,b){return new DOMParser().parseFromString(a,b||"application/xml");},formatXML:function(a){return new XMLSerializer().serializeToString(a);},getElementByTagNameId:function(a,d,e){var b=a.getElementsByTagName(d);for(var c=0;c<b.length;c++){if(e==b[c].id){return b[c];}}return null;},getElementsByTagName:function(a,b){return this.concat([],a.getElementsByTagName(b));},getElementsByTagNameClassName:function(d,a,f){var l=[];if(!d||!f){return l;}var h=f.split(" ");var k=d.getElementsByTagName(a);for(var c=0;c<k.length;c++){var e=k[c].className;if(!e){continue;}for(var b=0;b<h.length;b++){f=h[b];var g=e.indexOf(f);if(g==-1){continue;}if((g==0||" "==e.charAt(g-1))&&(g+f.length==e.length||" "==e.charAt(g+f.length))){l.push(k[c]);}}}return l;},recycleChild:function(c){if(!c||this.isW3C){return c;}var d=document.getElementById("recycleBin");if(!d){return c;}var a=c.getElementsByTagName("iframe");for(var b=0;b<a.length;b++){a[b].onload="";}d.appendChild(c);d.innerHTML="";return c;},removeChild:function(a){return this.recycleChild(a.parentNode.removeChild(a));},replaceChild:function(b,a,c){return this.recycleChild(b.replaceChild(a,c));},replaceTextDataAsArrayOrNull:function(h,c){var b=null;if(!h||!h.length){return b;}var f=0;var e=h.indexOf("{");if(e!=-1){b=[];}else{return b;}for(;e!=-1;e=h.indexOf("{",f)){b.push(h.substring(f,e));f=e+1;e=h.indexOf("}",f);if(e!=-1){var d=h.substring(f,e);var g=this.getProperty(c,d);if(g!=null){b.push(g);}else{b.push(h.substring(f-1,e+1));}f=e+1;}else{f=h.length;}}if(b.length){b.push(h.substring(f,h.length));}return b;},replaceNodeData:function(f,h){var j,c=[f];for(var l=c.pop();l!=null;l=c.pop()){var m=l.attributes;if(m){for(var e=0;e<m.length;e++){var g=m[e],b=g.nodeName,k=g.nodeValue;if(b.lastIndexOf("data--",6)==0){b=b.substring(6);l.removeAttribute(g.nodeName);j=this.replaceTextDataAsArrayOrNull(k,h);if(j!=null){l.setAttribute(b,j.join(""));}}else{j=this.replaceTextDataAsArrayOrNull(k,h);if(j!=null){g.nodeValue=j.join("");}}}}var n=l.childNodes;for(var e=0;e<n.length;e++){var d=n[e];switch(d.nodeType){case 1:c[c.length]=(d);case 3:case 4:j=this.replaceTextDataAsArrayOrNull(d.nodeValue,h);if(j!=null){d.nodeValue=j.join("");}break;}}}},cloneNodeByCreateElement:function(e,d,a){var f=e.createElement(d.nodeName);for(var c=0;c<d.attributes.length;c++){var b=d.attributes[c].name;switch(b){case"class":b="className";break;default:break;}f[b]=d.attributes[c].value;}if(a&&d.innerHTML){f.innerHTML=d.innerHTML;}return f;},cloneTemplateNode:function(a,c){var b=a.cloneNode(true);b.id=c?c:"";b.style.display="";return b;},importNode:function(g,d){var i,c,a=document.getElementById("recycleBin"),f=d.nodeName.toLowerCase();if("importNode" in g&&!("documentMode" in g&&g.documentMode==9)){i=g.createElement(f==="link"||f==="style"||f==="script"?"head":"div");if(f==="script"||f==="style"){i.appendChild(this.cloneNodeByCreateElement(g,d,true));}else{i.appendChild(g.importNode(d,true));}c=i.firstChild;i.removeChild(c);if(a){a.appendChild(i);}return c;}else{if(f==="link"||f==="style"||f==="script"){i=this.cloneNodeByCreateElement(g,d);var b=d.xml;var e=b.indexOf(">");if(e+1<b.length){var h=b.substring(e+1,b.lastIndexOf("<"));if(h>""){if(f==="style"){i.styleSheet.cssText=h;}else{if(f==="script"){i.text=h;}}}}return i;}else{i=g.createElement("div");i.innerHTML=d.xml;c=i.firstChild;i.removeChild(c);if(a){a.appendChild(i);}return c;}}},importElementsReplaceById:function(u,g,h){var t=[];var q=null;q={count:0,callbackFn:null,check:function(){if(console.logEnabled){console.log("scriptTracker.check count "+this.count);}if(this.count<1&&this.callbackFn){try{this.callbackFn();}catch(i){var a="scriptTracker.callbackFn: "+String(i);console.error(a);alert(a);}this.callbackFn=null;}},load:function(a){this.count++;a.onload=function(i){q.onload(i);};a.onreadystatechange=function(i){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){q.onload(i);}};if(console.logEnabled){console.log("scriptTracker.load count "+this.count);}},onload:function(i){if(i){var a=akme.getEventElement(i);a.onload=null;a.onreadystatechange=null;}this.count--;this.check();}};var n=[g];for(var l=n.pop();l!=null;l=n.pop()){var d=l.childNodes;for(var p=0;p<d.length;p++){var f=d[p];if(f.nodeType==1){var m=f.getAttribute("id")>""?u.getElementById(f.getAttribute("id")):null;if(m){var c=this.importNode(u,f);var b=c.nodeName.toLowerCase();var k=b==="script"?c:null;var e=k?[k]:c.getElementsByTagName("script");if(e&&e.length>0){for(var o=0;o<e.length;o++){var r=e[o];var s=this.cloneNodeByCreateElement(u,r,false);q.load(s);if(r.text>""){s.text=r.text;}if(!k){akme.replaceChild(r.parentNode,s,r);}else{c=s;}}}akme.replaceChild(m.parentNode,c,m);t[t.length]=c;}else{n[n.length]=(f);}}}}if(h){q.callbackFn=h;}q.check();return t;},importNodeAppendChild:function(c,b){var d;if(c.ownerDocument){d=c.ownerDocument;}else{d=c;c=d.getElementsByTagName("body")[0];}var a=this.importNode(d,b);c.appendChild(a);return a;},toggleDisplay:function(a){a.style.display=a.style.display!="none"?"none":"";},getAttributes:function(c,d){var a=c.attributes;d=d||{};for(var b=0;b<a.length;b++){d[a[b].name]=c.getAttribute(a[b].name);}return d;},setAttributes:function(b,c){for(var a in c){b.setAttribute(a,c[a]);}return b;}});if(!akme.xhr){akme.xhr={DATE_1970:"Thu, 01 Jan 1970 00:00:00 GMT",HTTP_OK:200,HTTP_NO_CONTENT:204,HTTP_NOT_MODIFIED:304,CONTENT_TYPE:"Content-Type",CONTENT_BINARY:{"Content-Type":"application/octet-stream"},CONTENT_TEXT:{"Content-Type":"text/plain"},CONTENT_URLENCODED:{"Content-Type":"application/x-www-form-urlencoded"},CONTENT_HTML:{"Content-Type":"text/html"},CONTENT_XHTML:{"Content-Type":"application/xhtml+xml"},CONTENT_XML:{"Content-Type":"text/xml"},CONTENT_JSON:{"Content-Type":"application/json"},NO_CACHE_HEADER_MAP:{Pragma:"no-cache","Cache-Control":"no-cache, no-store"},PRIVATE_CACHE_HEADER_MAP:{Pragma:"private","Cache-Control":"private"},PRIVATE_VALID_CACHE_HEADER_MAP:{Pragma:"private","Cache-Control":"private, must-revalidate"},PUBLIC_CACHE_HEADER_MAP:{Pragma:"public","Cache-Control":"public"},PUBLIC_VALID_CACHE_HEADER_MAP:{Pragma:"public","Cache-Control":"public, must-revalidate"},FUTURE_CACHE_HEADER_MAP:{Pragma:"public","Cache-Control":"public, max-age=900"},encodeMap:function(d){var c=[];if(!d){return"";}for(var b in d){var e=d[b];if(e&&e.constructor===Array){for(var a=0;a<e.length;a++){c.push(encodeURIComponent(b)+"="+encodeURIComponent(e[a]));}}else{c.push(encodeURIComponent(b)+"="+encodeURIComponent(e));}}return c.join("&");},decodeUrlEncoded:function(c){var d={};if(typeof c==="undefined"||c===null){return d;}var b=String(c).split("&");for(var a=0;a<b.length;a++){var e=b[a].split("=");d[decodeURIComponent(e[0])]=e.length>1?decodeURIComponent(e[1]):"";}return d;},open:function(d,a,b){var c=new XMLHttpRequest();c.open(d,a,b!=false);c.setRequestHeader("X-Requested-With","XMLHttpRequest");return c;},getXML:function(a){var b=this.open("GET",a,false);b.send(null);return this.getResponseXML(b);},getJSON:function(a){var b=this.open("GET",a,false);b.send(null);return this.getResponseJSON(b);},getResponseContentType:function(a){return a.contentType?(a.contentType||""):(a.getResponseHeader("Content-Type")||"");},getStatus:function(a){return(a.status&&a.status==1223)?204:a.status;},getResponseXML:function(c){var b=!!(c.responseXML&&c.responseXML.documentElement);var d=this.getResponseContentType(c);var a;if(c.responseXML&&!b&&"ActiveXObject" in window&&("application/xhtml+xml"==d)){a=new DOMParser().parseFromString(c.responseText,d);}else{a=c.responseXML;}if(a.documentElement.nodeName==="parsererror"){a=null;}return a;},getResponseJSON:function(b,a){return JSON.parse(b.responseText,a);},formatHttpHeaderName:function(c){var b=c.split("-");for(var d=0;d<b.length;d++){b[d]=b[d].charAt(0).toUpperCase()+b[d].substring(1);}return b.join("-");},fixHttpHeaderNames:function(d,e){for(var c=0;c<e.length;c++){e[c]=e[c].toLowerCase();}for(var b in d){if(Array.indexOf(e,b.toLowerCase())==-1){continue;}var a=this.formatHttpHeaderName(b);if(a!=b){d[a]=d[b];delete d[b];}}},parseHeaders:function(e){var d={};for(var c=0,b=e.indexOf("\n");b!=-1;c=b+1,b=e.indexOf("\n",c)){var a=e.indexOf(": ",c);if(a!=-1){d[this.formatHttpHeaderName(e.substring(c,a))]=e.substring(a+2,b).split("\r")[0];}}return d;},callAsync:function(f,a,e,b,c){var d=new XMLHttpRequest();this.callAsyncXHR(d,f,a,e,b,c);return d;},callAsyncXHR:function(i,a,c,d,f,e){var j=this;i.open(a,c,true);i.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var h in d){var b=this.formatHttpHeaderName(h);i.setRequestHeader(b,d[h]);if(b!=h){d[b]=d[h];delete d[h];}}if(d&&!(typeof f==="string"||f instanceof String)){var g=d["Content-Type"];if(/json;|json$/.test(g)){f=akme.formatJSON(f);}else{if(/xml;|xml$/.test(g)){f=akme.formatXML(f);}}}i.onreadystatechange=function(){var n=this;if(n.readyState!==4){return;}var m=j.parseHeaders(n.getAllResponseHeaders());m.status=j.getStatus(n);m.statusText=n.statusText;var l,k=m["Content-Type"];try{if(/json;|json$/.test(k)){l=j.getResponseJSON(n);}else{if(/xml;|xml$/.test(k)){l=j.getResponseXML(n);}else{l=n.responseText;}}}catch(o){m.status=500;m.statusText=String(o);l=n.responseText;}akme.handleEvent(e,m,l);j=n=e=null;};if(typeof f!=="undefined"){i.send(f);}else{i.send();}return;},callPromise:function(e,a,d,b){var c=new XMLHttpRequest();return this.callPromiseXHR(c,e,a,d,b);},callPromiseXHR:function(f,h,b,e,c){var a=this,d=new akme.core.Promise(g);function g(j,i){a.callAsyncXHR(f,h,b,e,c,function(l,k){if(l.status>=400){i(l,k);}else{j(l,k);}});}return d;}};}akme.cookieStorage=akme.cookieStorage||{name:"akme.cookieStorage",getItem:function(b){var c,d,a,f,e=document.cookie.split(";");for(c=0;c<e.length;c++){d=e[c].indexOf("=");a=e[c].substring(0,d);f=e[c].substring(d+1);a=a.replace(/^\s+|\s+$/g,"");if(a==b){return unescape(f);}}},setItem:function(a,c,b,e){var d=new Date();d.setDate(d.getDate()+(b?b:0));document.cookie=a+"="+escape(c)+(!b?"":"; expires="+d.toUTCString())+(!e?"":"; path="+e);},removeItem:function(a,b){document.cookie=a+"=; expires=0"+(!b?"":"; path="+b);}};if(!akme.core.MessageBroker){akme.core.MessageBroker=akme.extendClass(akme.copyAll(function(a){this.id=a.id;this.allowOrigins=a.allowOrigins;this.callbackKey=0;this.callbackMap={};this.callbackTime={};},{CLASS:"akme.core.MessageBroker"}),{destroy:function(){for(var a in this.callbackMap){delete this.callbackMap[a];}for(var a in this.callbackTime){delete this.callbackTime[a];}},newCallbackKey:function(){var a=this.callbackKey=(this.callbackKey+1)%65535;return a;},deleteCallbackKey:function(a){delete this.callbackMap[a];delete this.callbackTime[a];},callAsync:function(h,d,e){var g;if(h instanceof Element){g=arguments[0];h=arguments[1];d=arguments[2];e=arguments[3];}else{g=document.getElementById(this.id);}var c=this.newCallbackKey();h.callback=this.id+".callbackMap."+c;var b=this;b.callbackMap[c]=function(j,i){b.deleteCallbackKey(c);akme.handleEvent(e,j,i);b=c=e=null;};b.callbackTime[c]=new Date().getTime();akme.xhr.fixHttpHeaderNames(h,["Content-Type"]);if(/xml;|xml$/.test(h["Content-Type"])&&!(d instanceof String)&&d instanceof Object){d=akme.formatXML(d);}else{if(/json;|json$/.test(h["Content-Type"])&&!(d instanceof String)&&d instanceof Object){d=akme.formatJSON(d);}}var f=this.formatMessage(h,d);var a=g.src.substring(0,g.src.indexOf("/",8));g.contentWindow.postMessage(f,a);return h.callback;},submitAsync:function(c,d){var e={call:"SubmitRequest"};var b=this.newCallbackKey();e.callback=this.id+".callbackMap."+b;var a=this;a.callbackMap[b]=function(g,f){a.deleteCallbackKey(b);akme.handleEvent(d,g,f);a=b=d=null;};a.callbackTime[b]=new Date().getTime();a[e.call](e,{type:"submit",target:c});return e.callback;},handleEvent:function(b){var e=true;var a=location.hostname.indexOf(".")!==-1||location.hostname.indexOf(".local",location.hostname.length-6)==location.hostname.length-6;if(b.origin==location.href.substring(0,location.href.indexOf("/",8))||(!a&&b.origin.substring(b.origin.indexOf("/"))==location.href.substring(location.href.indexOf("/"),location.href.indexOf("/",8)))){e=false;}var c=this.parseMessage(b.data);if(e){console.error(this.id+" at "+location.href+" DENY "+c.call+" from "+b.origin);return;}var d=c.headers.callback;if(!c.headers.call||typeof this[c.headers.call]!=="function"||(d&&d.substring(0,d.lastIndexOf(".callbackMap."))!=this.id)){return;}this[c.headers.call].call(this,c.headers,c.content,b);},formatMessage:function(e,d){var b=[];b[b.length]="call: "+e.call;for(var c in e){if("call"!=c&&typeof e[c]!="undefined"){b[b.length]=c+": "+e[c];}}return b.join("\r\n")+"\r\n\r\n"+(d?d:"");},parseMessage:function(f){var d="";var e={};for(var c=0,b=f.indexOf("\n");b!=-1;c=b+1,b=f.indexOf("\n",c)){if(c+1>=b){d=f.substring(b+1);break;}var a=f.indexOf(": ",c);e[f.substring(c,a)]=f.substring(a+2,b).split("\r")[0];}return{headers:e,content:d};},XMLHttpRequest:function(b,d,c){var i=akme.xhr.open(b.method,b.url,true);var g=b.callback;var a=c.source;var e=c.origin;delete b.call;delete b.callback;delete b.method;delete b.url;if(b){for(var f in b){i.setRequestHeader(f,b[f]);}}var h=this;i.onreadystatechange=function(){var p=this;if(p.readyState!==4){return;}var o={call:"XMLHttpResponse",readyState:p.readyState,status:p.status?p.status:0,statusText:p.statusText?p.statusText:""};if(g){o.callback=g;}var m=p.getAllResponseHeaders();if(m){akme.copyAll(o,akme.xhr.parseHeaders(m));}var n=p.responseText?p.responseText:"";if(/xml;|xml$/.test(o["Content-Type"])||/html;|html$/.test(o["Content-Type"])){var l=n.indexOf("<!DOCTYPE ");var k=l!==-1?n.indexOf(">",l+10):-1;if(k!==-1&&(n.lastIndexOf(" SYSTEM ",k)!==-1||(document.documentMode&&document.documentMode<9&&n.lastIndexOf(" PUBLIC ",k)===-1))){n=n.substring(0,l)+n.substring(n.indexOf("<",k+1));}}var j=h.formatMessage(o,n);if(window.console){console.log(h.id+" "+location.protocol+"//"+location.host+" XMLHttpRequest postMessage back "+String(c.origin||e));}if(c.source){c.source.postMessage(j,c.origin);}else{a.postMessage(j,e);}h=p=g=c=a=e=null;};i.send(d||null);},XMLHttpResponse:function(d,b){var c=akme.getProperty(window,d.callback);if(c&&(d.status==200||d.status==204||d.status==304)){if(/xml;|xml$/.test(d["Content-Type"])){var a=b;try{a=akme.parseXML(b,"application/xml");}catch(f){d.status=500;d.statusText=String(f);}if(c&&typeof a==="object"&&("childNodes" in a)){if(a.firstChild.nodeName.lastIndexOf(":Envelope")!==-1&&a.firstChild.lastChild.nodeName.lastIndexOf(":Body")!==-1){a=a.firstChild.lastChild.firstChild;}}akme.handleEvent(c,d,a);}else{if(/json;|json$/.test(d["Content-Type"])){var e=b;try{e=akme.parseJSON(b);}catch(f){d.status=500;d.statusText=String(f);}akme.handleEvent(c,d,e);}else{akme.handleEvent(c,d,b);}}return;}if(console.logEnabled){console.log(akme.formatJSON(d)+"\n\n"+b);}if(c){akme.handleEvent(c,d,b);}},StorageRequest:function(c,f,d){var e=akme.localStorage;var h=c.callback;var a=d.source;var g=d.origin;if(f){if("importAll"===c.method){e[c.method](akme.parseJSON(f));}else{f=e[c.method](c.type,c.key,f);}}else{f=e[c.method](c.type,c.key);}if(typeof f==="object"){f=akme.formatJSON(f);}var b=c;c={call:"StorageResponse",method:b.method,type:b.type,key:b.key};if(h){c.callback=h;}var i=this.formatMessage(c,f);if(window.console){console.log(this.id+" "+location.protocol+"//"+location.host+" StorageRequest postMessage back "+String(d.origin||g));}if(d.source){d.source.postMessage(i,d.origin);}else{a.postMessage(i,g);}},StorageResponse:function(c,a){var b=akme.getProperty(window,c.callback);if(b){akme.handleEvent(b,c,akme.parseJSON(a));return;}if(console.logEnabled){console.log(akme.formatJSON(c)+"\n\n"+a);}},SubmitRequest:function(f,d){var b=this;var c=d.target;var e=c.nodeName.toLowerCase();if("form"==e){if(typeof c.onsubmit==="function"&&!c.onsubmit(d)){return a();}var g=c.elements.callback;if(!g){g=c.ownerDocument.createElement("input");g.setAttribute("type","hidden");g.setAttribute("name","callback");c.appendChild(g);}g.value=f.callback;c.submit();return;}else{if(console.logEnabled){console.log("submitAsync called with unknown Element ",c);}return a();}function a(){b.SubmitResponse({call:"SubmitResponse",callback:f.callback},null);return;}},SubmitResponse:function(c,a){var b=akme.getProperty(window,c.callback);if(b){if(/json;|json$/.test(c["Content-Type"])&&a){a=akme.parseJSON(a);}akme.handleEvent(b,c,a);}else{if(console.logEnabled){console.log(akme.formatJSON(c)+"\n\n"+a);}}}});}akme.copy(akme,{getParentElementByTagNameClassName:function(c,b,g){if(!c||!b||!g){return null;}var e=b.toUpperCase();var a=c;var i=g.split(" ");while(a&&a.parentNode&&a!=a.parentNode){a=a.parentNode;if(a.nodeName==e){var f=a.className;if(!f){continue;}for(var d=0;d<i.length;d++){g=i[d];var h=f.indexOf(g);if(h===-1){continue;}if((h===0||" "==f.charAt(h-1))&&(h+g.length==f.length||" "==f.charAt(h+g.length))){return a;}}}}},toggleClass:function(d,g){var f=d.className;var a=[].concat(f.split(" "));var e=[];for(var b=0;b<a.length;b++){if(g!=a[b]){e[e.length]=(a[b]);}}if(e.length==a.length){e[e.length]=(g);}d.className=e.join(" ");},hasClass:function(d,f){var e=d.className;var a=[].concat(e.split(" "));for(var b=0;b<a.length;b++){if(f==a[b]){return true;}}return false;},xml2js:function(g){var f={};if(g.nodeType==1){if(g.attributes.length>0){for(var d=0;d<g.attributes.length;d++){f[g.attributes[d].nodeName]=g.attributes[d].nodeValue;}}}else{if(g.nodeType==3){f.$=g.nodeValue;}}if(g.hasChildNodes()){var c,b;for(var e=0;e<g.childNodes.length;e++){c=g.childNodes[e].nodeName;if(typeof(f[c])=="undefined"){f[c]=this.xml2js(g.childNodes[e]);}else{b=f[c];if(typeof(b.length)=="undefined"){b=[b];}if(typeof(b)=="object"){b[b.length]=(this.xml2js(g.childNodes[e]));}f[c]=b;}}}return f;},xml2jsReviver:function(c,d){if(typeof d==="string"&&(c.indexOf("Date",c.length-4)!=-1||c.indexOf("Datetime",c.length-8)!=-1||c.indexOf("DateTime",c.length-8)!=-1)){var b=/^(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z?$/.exec(d);if(b&&d.charAt(d.length-1)==="Z"){return new Date(Date.UTC(+b[1],+b[2]-1,+b[3],+b[4],+b[5],+b[6]));}else{if(b){return new Date(+b[1],+b[2]-1,+b[3],+b[4],+b[5],+b[6]);}}}return d;},timer:{items:[],clear:function(){this.items=[];},add:function(a){this.items.push([a,new Date()]);},getName:function(a){return this.items[a][0];},getValue:function(a){return this.items[a][1];},getDiff:function(a){return this.items[a][1]-this.items[a-1][1];},getDiffOverall:function(){return this.items[this.items.length-1][1]-this.items[0][1];},appendInfoToElement:function(e){var c=this.items;var b=[];for(var d=0;d<c.length;d++){b.push((c[d][0]?c[d][0]+" : ":"")+(d===0?c[d][1]:c[d][1]-c[d-1][1]));}e.appendChild(document.createTextNode("{"+b.join(", ")+"}"));}}});if(!akme.form){akme.form={getFormElements:function(f){var b=[];var g=["button","input","select","textarea"];for(var e=0;e<g.length;e++){var d=f.getElementsByTagName(g[e]);for(var c=0;c<d.length;c++){b[b.length]=(d[c]);}}return b;},cloneFormElementValues:function(e,h){var c=this.getFormElements(e);var g=this.getFormElements(h);for(var b=0;b<c.length&&b<g.length;b++){var f=c[b];var d=g[b];if(f.checked){d.checked=true;}else{if(f.selectedIndex>=-1){d.selectedIndex=f.selectedIndex;if(f.multiple){for(var a=0;a<f.options.length;a++){if(f.options[a].selected){d.options[a].selected=true;}}}}else{if(f.value){d.value=f.value;}}}}},getValue:function(c){var a=c instanceof NodeList?c[0]:c;var d=a.nodeName.toLowerCase();if("select"==d){return c.options[c.selectedIndex].value;}else{if("input"==d&&("radio"==a.type||"checkbox"==a.type)){if("length" in a){for(var b=0;b<a.length;b++){if(a[b].checked){return a[b].value;}}return"";}return c.checked?c.value:"";}else{return c.value;}}},setValue:function(e,f){var b=e instanceof NodeList?e[0]:e,g=b.nodeName.toLowerCase();if("select"==g){for(var c=0;c<e.options.length;c++){var a=e.options[c];a.selected=(a.value==f);if(a.selected){e.selectedIndex=c;}}}else{if("input"==g&&("radio"==b.type||"checkbox"==b.type)){if("length" in b){for(var c=0;c<b.length;c++){var d=b[c];d.checked=(f==d.value);}}else{e.checked=(f==e.value);}}else{e.value=f;}}},setChecked:function(a,b){this.setValue(a,b);},setSelected:function(a,b){this.setValue(a,b);},getIntoMap:function(e,g){g=g||{};for(var b=0;b<e.elements.length;b++){var d=e.elements[b];if(!("name" in d)||d.name.length===0){continue;}var f=this.getValue(d);var a=-1;if(d.name in g){var c=g[d.name];if(c instanceof Array){a=c.length;c[c.length]=f;}else{g[d.name]=[c,f];}}else{g[d.name]=f;}if(console.logEnabled){console.log("get ",e.name,(a!=-1?d.name+"["+b+"]":d.name),f);}}return g;},setFromMap:function(d,f){for(var b in f){var c=d.elements[b];if(!c){continue;}var e=f[b];var g=(e instanceof Array);if(!g){e=[e];}if(!(c instanceof NodeList)){c=[c];}for(var a=0;a<e.length&&a<c.length;a++){this.setValue(c[a],e[a]);if(console.logEnabled){console.log("set ",d.name,g?c[a].name+"["+a+"]":c.name,g?c[a].value:c.value);}}}return d;}};}akme.selectHelper=akme.selectHelper||{timeout:1500,timestamp:0,text:"",elem:null,focus:function(b,a){this.text="";this.elem=b;this.timestamp=0;return true;},keypress:function(d){if(!d){d=window.event;}if(!d){return false;}var c=(d.target)?d.target:d.srcElement;if(!c){return false;}var a=d.keyCode?d.keyCode:d.which;var b=new Date().getTime();if(this.timestamp===0){this.timestamp=b;}else{if(this.elem!==c||b-this.timestamp>this.timeout){this.text="";this.timestamp=b;}}this.elem=c;if((a==32||a>=48)&&!String.fromCharCode(a).match(akme.PRINTABLE_EXCLUDE_REGEXP)){if(a!=32){this.text+=String.fromCharCode(a);}this.find(c);if(d.cancelable){d.preventDefault();}if(d.bubbles){d.stopPropagation();}return false;}else{this.text="";this.timestamp=0;return true;}},find:function(d){var c=d.selectedIndex>0?d.selectedIndex:0;var b=c>0?(d.options[c].text.toUpperCase()<this.text.toUpperCase()):false;var e=c>0&&b?c:0;var a=c>0&&!b?c:d.options.length-1;while(e<=a){c=Math.floor(e+(a-e)/2);b=(d.options[c].text.toUpperCase()<this.text.toUpperCase());if(b){e=c+1;}else{a=c-1;}}d.selectedIndex=(b&&c+1<d.options.length)?c+1:c;}};akme.copy(akme.xhr,{getXmlHttpResponse:function(a,h,e,f){var g=new XMLHttpRequest();var d=[0,""];try{if(f){g.open("GET",a+"?"+this.encodeMap(f),false);}else{g.open("GET",a,false);}if(e){for(var c in e){g.setRequestHeader(c,e[c]);}}g.send("");d[0]=g.status;if(!h||(g.status&&g.status!=this.HTTP_OK)){d[1]=g.statusText;}else{d[1]=g.responseText;}}catch(b){d=[b.number,b.description];throw b;}finally{g=null;}return d;},postXmlHttp:function(a,d,f,c){var h=new XMLHttpRequest();var b=[0,""];try{h.open("POST",a,false);var i=false;if(f){for(var g in f){h.setRequestHeader(g,f[g]);if(g.toLowerCase()=="content-type"){i=true;}}}if(!i){h.setRequestHeader(this.CONTENT_TYPE,this.CONTENT_XML[this.CONTENT_TYPE]);}h.send(c);b[0]=h.status;if(!d||(h.status&&h.status!=this.HTTP_OK)){b[1]=h.statusText;}else{b[1]=h.responseText;}}catch(e){b=[e.number,e.description];}finally{h=null;}return b;}});if(!akme._callbasep){akme._callbasep={_tag:"",_lock:[true],_count:0,timeout:9000,cleanup:function(d,b,c){if(!b){b=document;}var a=b.getElementById(d);return(a&&(!c||a.title==c))?a.parentNode.removeChild(a):null;},call:function(f,d,a,e){if(!e){e=document;}var b=this._lock.pop()===true;if(!b||!d||e.getElementById(d)){if(b){this._lock.push(true);}return false;}var g=d+"_"+(++this._count);var c=e.createElement(this._tag);c.id=d;c.className=this._tag+"p";c.title=g;c.src=f;if("iframe"==this._tag){c.onload=function(){setTimeout(d+'(document.getElementById("'+d+'").contentDocument)',0);};}e.body.appendChild(c);if(b){this._lock.push(true);}var h=this;setTimeout(function(){var i=h.cleanup(d,e,g);if(i&&a){a(i);}},this.timeout);return true;}};}if(!akme.iframep){akme.iframep=akme.copy(akme.clone(akme._callbasep),{_tag:"iframe"});}if(!akme.scriptp){akme.scriptp=akme.copy(akme.clone(akme._callbasep),{_tag:"script"});}if(!akme.hsv2rgb){akme.hsv2rgb=function(h){var e,n,l,g,k,b,a,m;if(h[2]===0){return[0,0,0];}var j=h[0]%360,d=h[1]/100,c=h[2]/100;j=j/60;g=Math.floor(j);k=j-g;b=c*(1-d);a=c*(1-(d*k));m=c*(1-(d*(1-k)));switch(g){case 0:e=c;n=m;l=b;break;case 1:e=a;n=c;l=b;break;case 2:e=b;n=c;l=m;break;case 3:e=b;n=a;l=c;break;case 4:e=m;n=b;l=c;break;case 5:e=c;n=b;l=a;break;}return[Math.floor(e*255),Math.floor(n*255),Math.floor(l*255)];};}if(!akme.rgb2hsv){akme.rgb2hsv=function(j){var k,g,d,e,b,a;var c=j[0]/255,l=j[1]/255,h=j[2]/255;k=Math.min(Math.min(c,l),h);a=Math.max(Math.max(c,l),h);if(k==a){return[undefined,0,a*100];}g=(c==k)?l-h:((l==k)?h-c:c-l);d=(c==k)?3:((l==k)?5:1);e=Math.floor((d-g/(a-k))*60)%360;b=Math.floor(((a-k)/a)*100);a=Math.floor(a*100);return[e,b,a];};}if(!akme.rgb2hex){akme.rgb2hex=function(a){return this.toHexByte(a[0])+this.toHexByte(a[1])+this.toHexByte(a[2]);};}if(!akme.toHexByte){akme.toHexByte=function(a){if(a==null){return"00";}a=parseInt(a);if(a===0||isNaN(a)){return"00";}a=Math.max(0,a);a=Math.min(a,255);a=Math.round(a);return"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16);};}(function(e,n){if(e.getProperty(e.THIS,n)){return;}var c=":";function o(p){e.core.EventSource.apply(this);this.getStorage=function(){return p;};}e.extendClass(e.copyAll(o,{CLASS:n}),{getItem:m,getItemJSON:l,setItem:g,setItemJSON:j,removeItem:k,getAll:d,setAll:a,removeAll:h,exportAll:i,importAll:b,clear:f});e.setProperty(e.THIS,n,o);function m(q,p){var r=this.getStorage().getItem(q+c+p);this.doEvent({type:"getItem",keyType:q,key:p,value:r});return r;}function l(q,p){var r=akme.parseJSON(this.getStorage().getItem(q+c+p));this.doEvent({type:"getItem",keyType:q,key:p,value:r});return r;}function g(q,p,r){this.getStorage().setItem(q+c+p,r);this.doEvent({type:"setItem",keyType:q,key:p,value:r});}function j(q,p,r){this.getStorage().setItem(q+c+p,akme.formatJSON(r));this.doEvent({type:"setItem",keyType:q,key:p,value:r});}function k(q,p){this.getStorage().removeItem(q+c+p);this.doEvent({type:"removeItem",keyType:q,key:p});}function d(s){var v=this.getStorage();var u=s+c;var t=0;var p={};for(var r=0;r<v.length;r++){var q=v.key(r);if(q.lastIndexOf(u,u.length)===0){p[q.substring(u.length)]=v.getItem(q);t++;}}this.doEvent({type:"getAll",keyType:s,count:t,result:p});return p;}function a(q,t){var u=this.getStorage();var r=0;for(var s in t){var p=q+c+s;u.setItem(p,t[s]);r++;}this.doEvent({type:"setAll",keyType:q,count:r,map:t});}function h(r){var u=this.getStorage();var t=r+c;var s=0;for(var q=u.length-1;q>=0;q--){var p=u.key(q);if(p.lastIndexOf(t,t.length)===0){u.removeItem(p);s++;}}this.doEvent({type:"removeAll",keyType:r,count:s});}function i(){var s=this.getStorage();var p={};var r=0;for(var q=0;q<s.length;q++){p[s.key(q)]=s.getItem(s.key(q));r++;}this.doEvent({type:"exportAll",count:r,result:p});return p;}function b(r){var s=this.getStorage();var q=0;for(var p in r){s.setItem(p,r[p]);q++;}this.doEvent({type:"importAll",count:q});}function f(){var p=this.size();this.getStorage().clear();this.doEvent({type:"clear",count:p});}})(akme,"akme.dom.Storage");if(!akme.localStorage){akme.localStorage=new akme.dom.Storage({name:"localStorage",length:typeof localStorage!=="undefined"?localStorage.length:0,size:function(){this.length=localStorage.length;return this.length;},key:function(a){return localStorage.key(a);},getItem:function(a){return localStorage.getItem(a);},setItem:function(a,b){localStorage.setItem(a,b);this.length=localStorage.length;},removeItem:function(a){localStorage.removeItem(a);this.length=localStorage.length;},clear:function(){localStorage.clear();this.length=localStorage.length;}});}if(!akme.sessionStorage){akme.sessionStorage=new akme.dom.Storage({name:"sessionStorage",length:typeof sessionStorage!=="undefined"?sessionStorage.length:0,size:function(){this.length=sessionStorage.length;return this.length;},key:function(a){return sessionStorage.key(a);},getItem:function(a){return sessionStorage.getItem(a);},setItem:function(a,b){sessionStorage.setItem(a,b);this.length=sessionStorage.length;},removeItem:function(a){sessionStorage.removeItem(a);this.length=sessionStorage.length;},clear:function(){sessionStorage.clear();this.length=sessionStorage.length;}});}(function(i,n){if(i.getProperty(i.THIS,n)){return;}var c="application/json";function k(q,p){this.name=q;this.url=p;this.cacheMap={};var o=i.getProperty(i.THIS,q);if(typeof o==="function"){this.dataConstructor=o;}i.core.EventSource.apply(this);}i.extendClass(i.copyAll(k,{CLASS:n}),i.copyAll(new i.core.Access(),{clear:j,findOne:g,info:d,copy:a,read:b,write:m,remove:h}));i.setProperty(i.THIS,n,k);function l(o,p){if("jsonReviver" in this.constructor){return this.constructor.jsonReviver.call(this,o,p);}else{return p;}}function f(o,p){if("jsonReplacer" in this.constructor){return this.constructor.jsonReplacer.call(this,o,p);}else{return p;}}function e(u,o,t,r){var s=null;for(var q=0;q<1;q++){if(q!==0){}s=i.xhr.open(u,o,false);for(var p in t){s.setRequestHeader(p,t[p]);}if(typeof r!=="undefined"&&r!==null){s.send(r);}else{s.send();}if(s.status!=401){break;}}return s;}function j(){if(this.cacheMap){this.cacheMap={};}else{i.sessionStorage.removeAll(this.name);}}function g(p){var o=this.find(p);return o.length===0?o[0]:null;}function d(s){var p=this;var r=p.url+"/"+encodeURIComponent(s);var v=e("HEAD",r,{Accept:c},null);var o=v.getResponseHeader("ETag");var u={id:s,rev:(o?o.replace(/^"|"$/g,""):null),status:v.status,statusText:v.statusText};for(var q in {"Cache-Control":1,"Content-Encoding":1,"Content-Length":1,"Content-Type":1,Date:1,ETag:1,Expires:1,"Last-Modified":1,Pragma:1,Server:1,Vary:1,Warning:1}){var t=v.getResponseHeader(q);if(t){u[q]=t;}}if(console.logEnabled){console.log("HEAD "+r,v.status,v.statusText,u.rev);}this.doEvent({type:"info",keyType:this.name,key:s,info:u});return u;}function a(u,t){var w=this;var o=w.url+"/"+encodeURIComponent(u);var v=e("COPY",o,{Accept:c,Destination:t},null);var s=v.getResponseHeader("ETag");var r={id:u,rev:(s?s.replace(/^"|"$/g,""):null),status:v.status,statusText:v.statusText};for(var p in {"Cache-Control":1,"Content-Encoding":1,"Content-Length":1,"Content-Type":1,Date:1,ETag:1,Expires:1,"Last-Modified":1,Pragma:1,Server:1,Vary:1,Warning:1}){var q=v.getResponseHeader(p);if(q){r[p]=q;}}if(console.logEnabled){console.log("COPY "+o,t,v.status,v.statusText,r.rev);}this.doEvent({type:"copy",keyType:this.name,key:u,newKey:t,info:r});return r;}function b(q){var o=this;var p=o.url+"/"+encodeURIComponent(q);var t=e("GET",p,{Accept:c},null);var r=i.xhr.getResponseContentType(t);if(console.logEnabled){console.log("GET "+p,t.status,t.statusText,r);}var s=(t.status<400&&r&&r.indexOf(c)===0)?t.responseText:null;if(s){if(this.cacheMap){this.cacheMap[q]=s;}else{i.sessionStorage.setItem(o.name,q,s);}s=i.parseJSON(s,l);}else{if(this.cacheMap){delete this.cacheMap[q];}else{i.sessionStorage.removeItem(o.name,q);}}if(this.dataConstructor&&s){s=new this.dataConstructor(s);}this.doEvent({type:"read",keyType:this.name,key:q,value:s});return s;}function m(r,t){var p=this;var v=this.cacheMap?this.cacheMap[r]:i.sessionStorage.getItemJSON(p.name,r);if(v&&v._id){t._id=v._id;t._rev=v._rev;}var q=p.url+"/"+encodeURIComponent(r);var u=e("PUT",q,{Accept:c,"Content-Type":c},typeof t=="string"?t:i.formatJSON(t,f));var s=i.xhr.getResponseContentType(u);if(console.logEnabled){console.log("PUT "+q,u.status,u.statusText,s);}var o=(s&&s.indexOf(c)===0)?i.parseJSON(u.responseText):u.responseText;if(o.ok&&o.rev){t._id=o.id;t._rev=o.rev;if(this.cacheMap){this.cacheMap[r]=t;}else{i.sessionStorage.setItem(p.name,r,i.formatJSON(t,f));}}this.doEvent({type:"write",keyType:this.name,key:r,value:t});return o;}function h(s,p){var q=this,r,u;if(!p){r=q.url+"/"+encodeURIComponent(s);u=e("HEAD",r,{Accept:c});p=u.getResponseHeader("ETag");if(p){p=p.replace(/^"|"$/g,"");}if(!p){p="";}}r=q.url+"/"+encodeURIComponent(s)+"?rev="+encodeURIComponent(p);u=e("DELETE",r,{Accept:c});var t=i.xhr.getResponseContentType(u);if(console.logEnabled){console.log("DELETE "+r,u.status,u.statusText,t);}var o=(t&&t.indexOf(c)===0)?i.parseJSON(u.responseText):u.responseText;if(o.ok&&o.rev){if(this.cacheMap){delete this.cacheMap[s];}else{i.sessionStorage.removeItem(q.name,s);}}this.doEvent({type:"remove",keyType:this.name,key:s});return o;}})(akme,"akme.core.CouchAccess");(function(j,q){if(j.getProperty(j.THIS,q)){return;}var c="application/json";function k(t,s){this.name=t;this.url=s;this.cacheMap={};var r=j.getProperty(j.THIS,t);if(typeof r==="function"){this.dataConstructor=r;}j.core.EventSource.apply(this);}j.extendClass(j.copyAll(k,{CLASS:q}),j.copyAll(new j.core.Access(),{clear:l,findOne:h,info:d,copy:a,read:b,write:o,remove:i}));j.setProperty(j.THIS,q,k);function m(r,s){if("jsonReviver" in this.constructor){return this.constructor.jsonReviver.call(this,r,s);}else{return s;}}function g(r,s){if("jsonReplacer" in this.constructor){return this.constructor.jsonReplacer.call(this,r,s);}else{return s;}}function f(w,r,v,s,t){var u=new XMLHttpRequest();e(u,w,r,v,s,t);return u;}function e(w,x,r,v,t,u){w.open(x,r,true);w.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var s in v){w.setRequestHeader(s,v[s]);}w.onreadystatechange=function(){var y=this;if(y.readyState==4){j.handleEvent(u,{type:"readystatechange",target:y});}};if(typeof t!=="undefined"){w.send(t);}else{w.send();}return;}function p(u,t){if(!u){u={};}u.status=t.status;u.statusText=t.statusText;for(var r in {"Cache-Control":1,"Content-Encoding":1,"Content-Length":1,"Content-Type":1,Date:1,ETag:1,Expires:1,"Last-Modified":1,Pragma:1,Server:1,Vary:1,Warning:1}){var s=t.getResponseHeader(r);if(s){u[r]=s;}}return u;}function l(){if(this.cacheMap){this.cacheMap={};}else{j.sessionStorage.removeAll(this.name);}}function h(s){var r=this.find(s);return r.length===0?r[0]:null;}function d(u,x,v){var r=this;var t=r.url+"/"+encodeURIComponent(u);var w=f("HEAD",t,{Accept:c},null,s);function s(z){var B=z.target;var y=B.getResponseHeader("ETag");var A={id:u,rev:(y?y.replace(/^"|"$/g,""):null)};p(A,B);if(console.logEnabled){console.log("HEAD "+t,B.status,B.statusText,A.rev);}r.doEvent({type:"info",keyType:r.name,key:u,info:A});j.handleEvent(v,A,A);r=B=u=v=null;}return w;}function a(u,x,v){var r=this;var t=r.url+"/"+encodeURIComponent(u);var w=f("COPY",t,{Accept:c,Destination:x},null,s);function s(z){var B=z.target;var y=B.getResponseHeader("ETag");var A={id:u,rev:(y?y.replace(/^"|"$/g,""):null)};p(A,B);if(console.logEnabled){console.log("COPY "+t,x,B.status,B.statusText,A.rev);}r.doEvent({type:"info",keyType:r.name,key:u,newKey:x,info:A});j.handleEvent(v,A,A);r=B=u=v=null;}return w;}function b(u,v){var r=this;var t=r.url+"/"+encodeURIComponent(u);var w=f("GET",t,{Accept:c},null,s);function s(y){var B=y.target;var x=j.xhr.getResponseContentType(B);if(console.logEnabled){console.log("GET "+t,B.status,B.statusText,x);}var A=p({},B);var z=(B.status<400&&x&&x.indexOf(c)===0)?B.responseText:null;if(z){if(this.cacheMap){this.cacheMap[u]=z;}else{j.sessionStorage.setItem(r.name,u,z);}z=j.parseJSON(z,m);}else{if(this.cacheMap){delete this.cacheMap[u];}else{j.sessionStorage.removeItem(r.name,u);}}if(r.dataConstructor&&z){z=new r.dataConstructor(z);}r.doEvent({type:"read",keyType:r.name,key:u,value:z,headers:A});j.handleEvent(v,z,A);r=B=u=v=null;}return w;}function n(y,u){var z=this;var w;if(y instanceof Array){w=new Array(y.length);for(var t=0;t<y.length;t++){w[t]=encodeURIComponent('"'+y[t]+'"');}}else{w=[];for(var s in y){w[w.length]=encodeURIComponent('"'+y[s]+'"');}}var r=z.url+"/_all_docs?include_docs=true&keys=["+w.join(",")+"]";var x=f("GET",r,{Accept:c},null,v);function v(D){var H=D.target;var C=j.xhr.getResponseContentType(H);if(console.logEnabled){console.log("GET "+r,H.status,H.statusText,C);}var G=p({},H);var F=(H.status<400&&C&&C.indexOf(c)===0)?H.responseText:null;if(F){F=j.parseJSON(F);var E=F?F.rows:null;if(E){for(var B=0;B<E.length;B++){if(this.cacheMap){this.cacheMap[y[B]]=j.formatJSON(E[B],g);}else{j.sessionStorage.setItem(z.name,y[B],j.formatJSON(E[B],g));}w[B]=E[B];if(z.dataConstructor&&w[B]){w[B]=new z.dataConstructor(w[B]);}}}}else{if(y instanceof Array){for(var B=0;B<y.length;B++){if(this.cacheMap){delete this.cacheMap[y[B]];}else{j.sessionStorage.removeItem(z.name,y[B]);}}}else{for(var A in y){if(this.cacheMap){delete this.cacheMap[A];}else{j.sessionStorage.removeItem(z.name,A);}}}}z.doEvent({type:"readMany",keyType:z.name,keys:y,value:w,headers:G});j.handleEvent(u,w,G);z=H=y=u=null;}return x;}function o(u,w,v){var r=this;var y=j.sessionStorage.getItemJSON(r.name,u);if(y&&y._id){w._id=y._id;w._rev=y._rev;}var t=r.url+"/"+encodeURIComponent(u);var x=f("PUT",t,{Accept:c,"Content-Type":c},typeof w=="string"?w:j.formatJSON(w,g),s);function s(B){var D=B.target;var A=j.xhr.getResponseContentType(D);if(console.logEnabled){console.log("PUT "+t,D.status,D.statusText,A);}var C=p({},D);var z=(A&&A.indexOf(c)===0)?j.parseJSON(D.responseText):D.responseText;if(z.ok&&z.rev){w._id=z.id;w._rev=z.rev;if(this.cacheMap){this.cacheMap[u]=w;}else{j.sessionStorage.setItem(r.name,u,j.formatJSON(w,g));}}r.doEvent({type:"write",keyType:r.name,key:u,value:w,headers:C});j.handleEvent(v,z,C);r=D=u=w=v=null;}return x;}function i(x,t,s){var z=this;var y=new XMLHttpRequest();var r=null;if(!t){r=z.url+"/"+encodeURIComponent(x);e(y,"HEAD",r,{Accept:c},null,w);}else{u();}function w(A){var B=A.target;t=B.getResponseHeader("ETag");if(t){t=t.replace(/^"|"$/g,"");}if(!t){t="";}u();}function u(){r=z.url+"/"+encodeURIComponent(x)+"?rev="+encodeURIComponent(t);e(y,"DELETE",r,{Accept:c},null,v);}function v(C){y=C.target;var B=j.xhr.getResponseContentType(y);if(console.logEnabled){console.log("DELETE "+r,y.status,y.statusText,B);}var D=p({},y);var A=(B&&B.indexOf(c)===0)?j.parseJSON(y.responseText):y.responseText;if(A.ok&&A.rev){if(this.cacheMap){delete this.cacheMap[x];}else{j.sessionStorage.removeItem(z.name,x);}}z.doEvent({type:"remove",keyType:z.name,key:x,headers:D});j.handleEvent(s,A,D);z=y=r=x=t=s=null;}return y;}})(akme,"akme.core.CouchAsyncAccess");