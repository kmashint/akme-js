!function(e){"use strict";var t=function(){},n=Array.prototype,r=Array.prototype.slice;"undefined"==typeof console&&(console={log:t,debug:t,info:t,warn:t,error:t,assert:t}),"undefined"==typeof console.logEnabled&&(console.logEnabled=!1),Function.prototype.getShortName||(Function.prototype.getShortName=function(e){var t=String(e?e.name:this.name);return t?t.substring(t.lastIndexOf(".")+1):void 0}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice,n=t.call(arguments,1),r=this,a=function(){},o=function(){return r.apply(this instanceof a?this:e||window,n.concat(t.call(arguments)))};return a.prototype=this.prototype,o.prototype=new a,o}),Object.values||(Object.values=function(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}),Object.forEach||(Object.forEach=function(e,t,n){if("function"==typeof e.forEach)e.forEach(t,n);else if(e instanceof Array||"undefined"!=typeof NodeList&&e instanceof NodeList)for(var r=0;r<e.length;r++)t.call(n||e,e[r],r,e);else for(var r in e)e.hasOwnProperty(r)&&t.call(n||e,e[r],r,e)}),Array.from||(Array.from=function(e,t,n){var r,a=e.length||0,o=new Array(a);if("function"==typeof t)for(r=0;a>r;r++)o[r]=t.call(n,e[r],r,e);else for(r=0;a>r;r++)o[r]=e[r];return o}),Array.binarySearch||(Array.binarySearch=function(e,t){for(var n=0,r=e.length,a=0;r>=n;)t>e[a=Math.floor((n+r)/2)]?n=a+1:r=t==e[a]?-2:a-1;return-2==r?a:-1});for(var a in{indexOf:1,lastIndexOf:1,every:1,filter:1,forEach:1,map:1,some:1,reduce:1,reduceRight:1})!function(e){Array[e]||(Array[e]=function(t){return n[e].apply(t,r.call(arguments,1))})}(a)}(this),this.akme||(this.akme={THIS:this,WHITESPACE_TRIM_REGEXP:/^\s*|\s*$/gm,PRINTABLE_EXCLUDE_REGEXP:/[^\x20-\x7e\xc0-\xff]/g,MILLIS_IN_HOUR:36e5,MILLIS_IN_DAY:864e5,noop:function(){},slice:Array.prototype.slice,isDefinedNotNull:function(e){return void 0!==e&&null!==e},isArray:Array.isArray||function(e){return e instanceof Array},isBoolean:function(e){return"boolean"==typeof e||e instanceof Boolean},isDate:function(e){return e instanceof Date},isFunction:function(e){return"function"==typeof e},isNumber:function(e){return"number"==typeof e||e instanceof Number},isString:function(e){return"string"==typeof e||e instanceof String},concat:function(e){for(var t=1;t<arguments.length;t++)for(var n=arguments[t],r=0;r<n.length;r++)e[e.length]=n[r];return e},deleteAll:function(e){if(e instanceof Array)e.length=0;else for(var t in e)e.hasOwnProperty(t)&&delete e[t]},clone:function(e){if(void 0===e||null===e)return e;if("function"==typeof e.clone)return e.clone();var t=Object.create(Object.getPrototypeOf(e));for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},copy:function(e,t,n){if(void 0===t||null===t)return e;n=!!n;for(var r in t)(n||t.hasOwnProperty(r))&&(e[r]=t[r]);return e},copyAll:function(e,t){return this.copy(e,t,!0)},copyExisting:function(e,t,n,r){if(void 0===t||null===t)return e;n=!!n,r=!!r;for(var a in t)a in e!==r&&(n||t.hasOwnProperty(a))&&(e[a]=t[a]);return e},copyAllExisting:function(e,t){return this.copyExisting(e,t,!0)},copyMissing:function(e,t){return this.copyExisting(e,t,!1,!0)},copyAllMissing:function(e,t){return this.copyExisting(e,t,!0,!0)},copyArrayToObject:function(e,t,n,r){if("undefined"!=typeof r)for(var a=0;a<t.length;a++)e[t[a][n]]=t[a][r];else for(var a=0;a<t.length;a++)e[t[a][n]]=t[a];return e},copyArray:function(e,t,n){var r,a=e.length||0,o=new Array(a);if("function"==typeof t)for(r=0;a>r;r++)o[r]=t.call(n,e[r],r,e);else for(r=0;a>r;r++)o[r]=e[r];return o},concatMapKeys:function(e,t){for(var n in t)e[e.length]=n;return e},getMapKeys:function(e){return this.concatMapKeys([],e)},getProperty:function(e,t,n){("string"==typeof t||t instanceof String)&&(t=t.split("."));for(var r=e,a=t.length,o=0;a>o;o++){if(!(t[o]in r))return n;r=r[t[o]]}return r},setProperty:function(e,t,n){("string"==typeof t||t instanceof String)&&(t=t.split("."));for(var r=e,a=t.length-1,o=0;a>o;o++)r=t[o]in r?r[t[o]]:r[t[o]]={};return r[t[a]]=n,r},extendClass:function(e,t){return t&&("function"==typeof t?e.prototype=Object.create(t.prototype):e.prototype=t),e.constructor=e.prototype.constructor,e.prototype.constructor=e,e},extendDestroy:function(e,t){this.extendFunction(e,"destroy",t,!0)},extendFunction:function(e,t,n,r){var a=e[t];a?r?e[t]=function(){n.apply(this,arguments),a.apply(this,arguments)}:e[t]=function(){a.apply(this,arguments),n.apply(this,arguments)}:e[t]=n},newApplyArgs:function(e,t){if(!t||0===t.length)return new e;switch(t.length){case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);default:for(var n=new Array(t.length),r=0;r<t.length;r++)n[r]="a["+r+"]";return new Function("f","a","return new f("+n.join(",")+");")(fn,t)}},handleEvent:function(e){if(e){var t=this.slice.call(arguments,1);"function"==typeof e?e.apply(void 0,t):e.handleEvent.apply(e,t)}},fixHandleEvent:function(e){if(document.documentMode&&document.documentMode<9&&"function"==typeof e.handleEvent&&!e.handleEvent._original){var t=e.handleEvent;e.handleEvent=function(n){t.call(e,n)},e.handleEvent._original=function(){return t}}return e},trim:function(e){return e.replace(this.WHITESPACE_TRIM_REGEXP,"")},limitLengthWithDots:function(e,t){return e=String(e),e.length>t?e.substring(0,t-3)+"...":e},padLeft:function(e,t,n){var r=String(e);if(r.length>=t)return r;if(r.length+1==t)return n+r;var a=new Array(1+(t>r.length?t-r.length:0));return a[a.length-1]=r,a.join(n?n:" ")},round2:function(e){return Math.round(100*e+.5)/100},round3:function(e){return Math.round(1e3*e+.5)/1e3},round:function(e,t){return Math.round(e/t+.5)*t},setValidDateTimeInt:function(e,t){var n=Math.floor(t/1e6),r=t%1e6;return this.setValidDateTime(e,Math.floor(n/1e4),Math.floor(n/100)%100,n%100,Math.floor(r/1e4),Math.floor(r/100)%100,r%100)},setValidDateTime:function(e,t,n,r,a,o,i,s){var l=new Date(t,parseInt(n||1,10)-1,parseInt(r||1,10),parseInt(a||0,10),parseInt(o||0,10),parseInt(i||0,10),parseInt(s||0,10));return l.getFullYear()!=t||l.getMonth()+1!=n||l.getDate()!=r?l=e:arguments.length>=5&&(l.getHours()!=a||l.getMinutes()!=o||l.getSeconds()!=i)?l=e:arguments.length>=8&&l.getMilliseconds()!=s&&(l=e),l},parseDate:function(e){var t=e.match(/([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?/),n=new Date(t[1],parseInt(t[3]||1,10)-1,parseInt(t[5]||1,10),parseInt(t[7]||0,10),parseInt(t[8]||0,10),parseInt(t[10]||0,10),t[12]?1e3*Number("0."+t[12]):0);return n},formatIsoDate:function(e){return e.getFullYear()+"-"+this.padLeft(e.getMonth()+1,2,"0")+"-"+this.padLeft(e.getDate(),2,"0")},formatIsoDateTime:function(e,t){t||(t="T");var n=1e6*(1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate())+1e4*e.getHours()+100*e.getMinutes()+e.getSeconds();return String(n).replace(/^(....)(..)(..)(..)(..)(..)/,"$1-$2-$3"+t+"$4:$5:$6."+String(e.getMilliseconds()+1e3).substring(1))},diffDays:function(e,t){return e instanceof Date&&(e=e.getTime()),t instanceof Date&&(t=t.getTime()),Math.floor((t-e+12*this.MILLIS_IN_HOUR)/this.MILLIS_IN_DAY)},getYearDayByIsoMonday:function(e){var t=3-(e.getDay()+6)%7,n=new Date(e.getTime());n.setDate(n.getDate()+t);var r=n.getFullYear(),a=Math.round((n.getTime()-new Date(n.getFullYear(),0,1).getTime())/this.MILLIS_IN_DAY-1)/7;return 1e3*r+7*a+3-t},getDateByIsoMonday:function(e,t){e=Math.floor(e),t=Math.floor(t);var n=new Date(e,0,4);return n.setDate(n.getDate()-(n.getDay()+6)%7+(t-1)),n}}),function(e,t){function n(){}function r(e){var t=[];if("undefined"==typeof e||null===e)return t;if("function"==typeof e)t[t.length]=this.read(e());else if(e instanceof Array)for(var n=0;n<e.length;n++)t[t.length]=this.read(e[n]);else if(e instanceof Object)for(var r in e)t[t.length]=this.read(r);else t[t.length]=this.read(e);return t}e.getProperty(e.THIS,t)||(e.extendClass(e.copyAll(n,{CLASS:t}),{clear:null,flush:null,sync:null,syncDecorator:null,find:null,findOne:null,findDecorator:null,read:null,readDecorator:null,readMany:r,write:null,remove:null}),e.setProperty(e.THIS,t,n))}(akme,"akme.core.Access"),function(e,t){function n(){}function r(){return this.constructor.CLASS+e.formatJSON(this)}e.getProperty(e.THIS,t)||(e.copyAll(n,{CLASS:t}),e.copyAll(n.prototype,{toString:r}),e.setProperty(e.THIS,t,n))}(akme,"akme.core.Data"),function(e,t){function n(){var e={map:{},ary:[]};this.PRIVATES=function(t){return t===y?e:void 0},this.length=e.ary.length}function r(e,t){return e[t]=this.PRIVATES(y).map,this}function a(){return this.PRIVATES(y).ary.length}function o(){return this.PRIVATES(y).ary.slice(0)}function i(e){return this.PRIVATES(y).ary[e]}function s(e,t){return t?this.PRIVATES(y).ary.slice(e,t):this.PRIVATES(y).ary.slice(e)}function l(e){var t=this.PRIVATES(y);return t.map[t.ary[e]]}function c(){for(var e=this.PRIVATES(y),t=new Array(e.ary.length),n=0;n<e.ary.length;n++)t[n]=e.map[e.ary[n]];return t}function u(e,t){var n=this.PRIVATES(y);t>=0||(t=n.ary.length);for(var r=new Array(t-e),a=e;t>a;a++)r[a-e]=n.map[n.ary[a]];return r}function h(e){return this.PRIVATES(y).map[e]}function f(e,t){var n=this.PRIVATES(y);e in n.map||(n.ary[n.ary.length]=e,this.length=n.ary.length),n.map[e]=t}function d(e){var t=this.PRIVATES(y);if(e in t.map){for(var n=0;n<t.ary.length;n++)if(t.ary[n]===e){t.ary.splice(n,1),this.length=t.ary.length;break}delete t.map[e]}}function p(){var e=this.PRIVATES(y);e.ary.splice(0,e.ary.length),this.length=0;for(var t in e.map)delete e.map[t]}function g(e,t,n){var r="undefined"!=typeof n;if(e instanceof Array||"number"==typeof e.length)for(var a=0;a<e.length;a++)this.set(e[a][t],r?e[a][n]:e[a]);else for(var o in e)e.hasOwnProperty(o)&&this.set(e[o][t],r?e[o][n]:e[o]);return this}function m(e,t,n){var r="undefined"!=typeof n;for(var a in e)this.set(e[a][t],r?e[a][n]:e[a]);return this}if(!e.getProperty(e.THIS,t)){var y={};e.extendClass(e.copyAll(n,{CLASS:t}),{size:a,linkMapTo:r,keys:o,key:i,keySlice:s,value:l,values:c,valueSlice:u,get:h,set:f,remove:d,clear:p,copyFrom:g,copyAllFrom:m}),e.setProperty(e.THIS,t,n)}}(akme,"akme.core.IndexedMap"),function(e,t){function n(t,n,r,a){if(1===n.key.length){var o=n.key[0];e.isNumber(o)?t.keyMap[r[o]]=a:t.keyMap[r[n.map[o]]]=a}else{for(var i=new Array(n.key.length),s=0;s<i.length;s++)i[s]=r[e.isNumber(n.key[s])?n.key[s]:n.map[n.key[s]]];t.keyMap[i.join(b)]=a}}function r(e){return function(){return x[e].apply(this.PRIVATES(S).body,arguments)}}function a(){var e={idx:-1,key:[],map:{},head:[],body:[],rowMap:null};this.PRIVATES=function(t){return t===S?e:void 0},this.length=e.body.length,this.width=e.head.length,this.keyMap={}}function o(){var e=this.PRIVATES(S);if(arguments.length>1){for(var t=new Array(e.body.length),n=0;n<t.length;n++)t[n]=e.body[n].join(arguments[1]);return t.join(arguments[0])}return x.join.apply(e.body,arguments)}function i(t){arguments.length>1&&(t=x.slice.call(arguments,0));var n=this.PRIVATES(S);if(n.head.length=0,e.deleteAll(n.map),t instanceof Array)for(var r=0;r<t.length;r++)n.map[t[r]]=r;else e.copy(n.map,t);this.width=n.head.length,e.isIE8||(n.rowMap={});for(var a in n.map)n.head[n.map[a]]=a,n.rowMap&&(n.rowMap[a]=function(e){return{get:function(){return this[n.map[e]]},set:function(t){this[n.map[e]]=t}}}(a))}function s(e){var t=this.PRIVATES(S);e instanceof Array||(e=[e||0]),t.key.length=e.length;for(var n=0;n<t.key.length;n++)t.key[n]=e[n]}function l(){var e=this.PRIVATES(S);return{key:e.key.slice(0),head:e.head.slice(0),headLength:e.head.length,bodyLength:e.body.length}}function c(){var t=this.PRIVATES(S);this.length=t.body.length=0,e.deleteAll(this.keyMap)}function u(e){this.body([e])}function h(e,t){for(var r=this.PRIVATES(S),a=0;a<e.length;a++){var o=e[a];t?(t=!1,this.head(o)):(r.rowMap&&Object.defineProperties(o,r.rowMap),r.body.push(o),n(this,r,o,r.body.length-1))}this.length=r.body.length}function f(e){for(var t=this.PRIVATES(S),r=0,a=0;r<e.length;r++){var o=e[r];if(0===t.head.length){var i={};for(var s in o)i[s]=a++;this.head(i)}var l=new Array(t.head.length);for(t.rowMap&&Object.defineProperties(l,t.rowMap),a=0;a<l.length;a++)l[a]=o[t.head[a]];t.body.push(l),n(this,t,l,t.body.length-1)}this.length=t.body.length}function d(e){var t=this.PRIVATES(S).map[e];return t>=0?t:-1}function p(t){var n=this.PRIVATES(S);return t>=0?void(e.isNumber(t)&&t>=0||t<n.body.length?n.idx=t:n.idx=-1):this.PRIVATES(S).idx}function g(e){var t=this.keyMap[arguments.length>1?x.slice.call(arguments,0).join(b):e instanceof Array?e.join(b):e];return t>=0?t:-1}function m(){return this.row(this.rowIndexByKey.apply(this,arguments))}function y(e){var t=this.PRIVATES(S);return t.body["undefined"!=typeof e?e:t.idx]}function v(){var e=this.PRIVATES(S),t=arguments[0],n=arguments[1];return 1===arguments.length&&(n=t,t=e.idx),e.body[t]["number"==typeof n?n:this.headIndex(name)]}function E(e){var t={},n=arguments.length>=2?arguments[1]:void 0;return this.forEach(function(r,a){var o,i=e.call(n,r,a,this);null!=i&&(o=t[i]||[],o[o.length]=r,1===o.length&&(t[i]=o))}),t}function T(t){var n=e.isString(t)?e.parseJSON(t):t;this.head(n.head),this.key(n.key),this.clearBody(),this.body(n.body)}function k(){var t=this.PRIVATES(S);return e.formatJSON({key:t.key,head:t.head,body:t.body})}if(!e.getProperty(e.THIS,t)){var S={},b="",x=Array.prototype;e.extendClass(e.copyAll(a,{CLASS:t,KEY_SEP:b}),{head:i,key:s,meta:l,clearBody:c,push:u,body:h,bodyObjects:f,headIndex:d,rowIndexByKey:g,rowIndex:p,rowByKey:m,row:y,value:v,fromJSON:T,toJSON:k,join:o,select:r("filter"),mapBy:E});for(var A in{concat:1,every:1,filter:1,forEach:1,indexOf:1,lastIndexOf:1,map:1,reduce:1,reduceRight:1,slice:1,some:1})a.prototype[A]=r(A);e.setProperty(e.THIS,t,a)}}(akme,"akme.core.DataTable"),function(e,t){function n(){if(!this.EVENTS){console.logEnabled&&console.log(this.constructor.CLASS+" injecting "+t+" arguments.length "+arguments.length);var n={eventMap:{}};this.EVENTS=function(e){return e===s?n:void 0},this.onEvent=a,this.unEvent=o,this.doEvent=i,e.extendDestroy(this,r)}}function r(){console.logEnabled&&console.log(this.constructor.CLASS+".destroy() "+t);var e=this.EVENTS(s);for(var n in e.eventMap)delete e.eventMap[n]}function a(t,n,r){if("function"!=typeof n&&"function"!=typeof n.handleEvent)throw new TypeError(this.constructor.CLASS+".onEvent given neither function(ev){...} nor { handleEvent:function(ev){...} }");var a=this.EVENTS(s),o=a.eventMap[t];o||(o=[],a.eventMap[t]=o);var i=e.fixHandleEvent(n);o.push({handler:i,once:!!r})}function o(e,t){var n=this.EVENTS(s),r=n.eventMap[e];if(r)for(var a=0;a<r.length;a++)r[a].handler===t&&r.splice(a,1)}function i(e){var t=this.EVENTS(s),n=t.eventMap[e.type];if(n)for(var r=0;r<n.length;r++){var a=n[r];"function"==typeof a.handler?a.handler.call(void 0,e):a.handler.handleEvent.call(a.handler,e),a.once&&n.splice(r--,1)}}if(!e.getProperty(e.THIS,t)){var s={};e.extendClass(Object,e.copyAll(n,{CLASS:t})),e.setProperty(e.THIS,t,n)}}(akme,"akme.core.EventSource"),function(e,t){function n(e){function t(){switch(i.state){case 0:i.state=1,i.args=arguments;case 1:r(i.callbackAry[i.state],i.self,i.args,!0);break;case 2:console.warn(String(new RangeError("cannot resolve after reject")))}}function a(){switch(i.state){case 0:i.state=2,i.args=arguments;case 2:r(i.callbackAry[i.state],i.self,i.args,!0);break;case 1:console.warn(String(new RangeError("cannot reject after resolve")))}}if(!(this instanceof n))return new n(e);var i={state:0,self:this,args:null,callbackAry:[[],[],[]]};this.PRIVATES=function(e){return e===s?i:void 0};try{e.call(i.self,t,a)}catch(l){o(l)}}function r(e,t,n,r){for(var a=0;a<e.length;a++)n?e[a].apply(t,n):e[a].call(t);r&&(e.length=0)}function a(){var e=arguments;return new n(function(t,n){t.apply(this,e)})}function o(){var e=arguments;return new n(function(t,n){n.apply(this,e)})}function i(){var e=this.PRIVATES(s),t=arguments,r=new n(function(){for(var n=this,r=arguments,a=0;2>a;a++)(function(a){var o=t[a];"function"==typeof o&&(t[a]=function(){try{var t=o.apply(e.self,arguments);"undefined"!=typeof t&&"function"==typeof t.then?t.then.apply(n,r):r[a].apply(n,"undefined"!=typeof t?[t]:arguments)}catch(i){r[1]&&r[1](i)}})})(a)});if(0===e.state)for(var a=0,o=Math.min(t.length,e.callbackAry.length);o>a;a++)t[a]&&e.callbackAry[2===a?0:a+1].push(t[a]);else{var i=t[0===e.state?2:e.state-1];i&&i.apply(e.self,e.args)}return r}if(!e.getProperty(e.THIS,t)){e.setProperty(e.THIS,t,n);var s={},l=akme;l.copyAll(n,{CLASS:t,fulfill:a,resolve:a,reject:o}).prototype={then:i,"catch":function(e){return this.then(void 0,e)}}}}(akme,"akme.core.Promise"),function(e,t){function n(t){var n={parent:e.getContext?e.getContext():null,map:{},count:0,refreshDate:null};this.PRIVATES=function(e){return e===y?n:void 0},e.core.EventSource.apply(this);var r=this;this.onEvent("refresh",function(a){n.refreshDate=new Date,t&&e.handleEvent(t,a),e.setProperty(e.THIS,v,function(){return r})}),this.refresh()}function r(){return m}function a(){this.doEvent({type:"refresh",context:this})}function o(){var t=this.PRIVATES(y),n=t.parent||m;this.doEvent({type:"destroy",context:this});for(var r in t.map)this.remove(r);n&&e.setProperty(e.THIS,v,function(){return n})}function i(){return this.PRIVATES(y).refreshDate}function s(){return this.PRIVATES(y).parent}function l(e){return"function"==typeof this.getQuiet(e)}function c(e){var t=this.PRIVATES(y);return e in t.map||t.parent&&t.parent.has(e)}function u(e){var t=this.PRIVATES(y),n=t.map[e];return void 0===n&&t.parent&&(n=t.parent.get(e)),n}function h(t){var n=this.getQuiet(t);return"function"==typeof n&&(n=e.newApplyArgs(n,Array.prototype.slice.call(arguments,1))),void 0===n&&(n=null),this.doEvent({type:"get",context:this,id:t,instance:n}),n}function f(e,t){var n=this.PRIVATES(y),r=n.map;e in r||n.count++;var a=r[e];return r[e]=t,this.doEvent({type:"set",context:this,id:e,instance:t,oldInstance:a}),a}function d(e){var t=this.PRIVATES(y),n=t.map;e in n&&t.count--;var r=n[e];return delete n[e],this.doEvent({type:"remove",context:this,id:e,instance:r}),r}function p(){return this.PRIVATES(y).count}function g(){var e=[],t=0;for(var n in this.PRIVATES(y).map)e[t++]=n;return e}if(!e.getProperty(e.THIS,t)){var m,y={},v="akme.getContext";e.extendClass(e.copyAll(n,{CLASS:t,getRoot:r}),{has:c,isFunction:l,getQuiet:u,get:h,set:f,remove:d,refresh:a,destroy:o,getIdCount:p,getIdArray:g,getParent:s,getRefreshDate:i}),e.setProperty(e.THIS,t,n),m=new n}}(akme,"akme.core.Context"),function(e,t){function n(e){a.call(this,function(n){console.logEnabled&&console.log(t+"()"),n.callback=e,r(n)})}function r(t){t.callback&&e.handleEvent(t.callback,t)}if(!e.getProperty(e.THIS,t)){var a=akme.core.Context;e.extendClass(e.copyAll(n,{CLASS:t,getRoot:a.getRoot}),e.copyAll(Object.create(a.prototype),{})),e.setProperty(e.THIS,t,n)}}(akme,"akme.core.AppContext"),function(e){function t(){this.xmldoc=new ActiveXObject("Msxml2.DOMDocument"),this.xmldoc.async=!1}akme.copyAll(akme,{isIE8:"documentMode"in document&&8===document.documentMode,isW3C:"addEventListener"in window}),(akme.isW3C||akme.isIE8)&&window.postMessage&&window.XMLHttpRequest||console.error("This browser is unsupported, it must be MSIE 8 or support HTML 5 with postMessage and XMLHttpRequest."),e.DOMParser||(e.DOMParser=t);var n=e.DOMParser.prototype.parseFromString;e.DOMParser.prototype.parseFromString=function(e,t){if(this.xmldoc){if(this.xmldoc.loadXML(e),0!==this.xmldoc.parseError.errorCode){var r=this.xmldoc.parseError;throw new SyntaxError("DOMParser error "+r.errorCode+" at line "+r.line+" pos "+r.linepos+": "+r.reason)}return this.xmldoc}try{this.xmldoc=n.call(this,e,t)}catch(a){if(!(a instanceof SyntaxError))throw new SyntaxError(a)}if(!this.xmldoc||!this.xmldoc.documentElement)throw new SyntaxError("Invalid XML: "+e);if(this.xmldoc.getElementsByTagName("parsererror").length)throw new SyntaxError(this.xmldoc.documentElement.innerHTML);return this.xmldoc},e.XMLSerializer||(e.XMLSerializer=function(){}),(!e.XMLSerializer.prototype.serializeToString||document.documentMode&&9==document.documentMode)&&(e.XMLSerializer.prototype.serializeToString=function(e){return e.xml}),e.XMLHttpRequest||(e.XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){throw new Error("This browser does not support XMLHttpRequest.")}})}(this),akme.copyAll(this.akme,{_html5:null,onContent:function(e){function t(e){if(!(e&&"load"===e.type||/interactive|complete/.test(a.readyState)))return!1;if(r.isW3C)a.removeEventListener(o,t,!1),window.removeEventListener("load",t),n();else{a.detachEvent("onreadystatechange",t),window.detachEvent("onload",t);var i,s=!1,l=document.createElement("div");try{s=null===window.frameElement}catch(c){}l.doScroll&&s&&window.external?i=setInterval(function(){try{l.doScroll(),clearInterval(i),n()}catch(e){}},50):n()}}function n(){r.onContent.ready||(r.onContent.ready=!0),setTimeout(function(){r.handleEvent(e,{type:o,target:a})})}var r=this,a=document,o="DOMContentLoaded";r.onContent.ready?n():t()||(r.isW3C?(a.addEventListener(o,t,!1),window.addEventListener("load",t,!1)):(a.attachEvent("onreadystatechange",t),window.attachEvent("onload",t)))},onLoad:function(e){this.onEvent(window,"load",e)},onUnload:function(e){this.onEvent(window,"unload",e)},onEvent:function(e,t,n){"click"===t&&window.Touch&&this.onEventTouch?this.onEventTouch(e,n):this.isW3C?e.addEventListener(t,n,!1):e.attachEvent("on"+t,"function"==typeof n.handleEvent?this.fixHandleEvent(n).handleEvent:n)},unEvent:function(e,t,n){"click"===t&&window.Touch&&this.unEventTouch?this.unEventTouch(e,n):this.isW3C?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,"function"==typeof n.handleEvent?n.handleEvent:n)},fixHandleEvent:function(e){if(this.isIE8&&"function"==typeof e.handleEvent&&!e.handleEvent._ie8fix){var t=e.handleEvent;e.handleEvent=function(){t.apply(e,arguments)},e.handleEvent._ie8fix=function(){return t}}return e},getEventElement:function(e){return 1===e.target.nodeType?e.target:e.target.parentNode},getEventCurrentTarget:function(e,t){if(e.currentTarget)return e.currentTarget;var n=this.getEventElement(e);if("function"==typeof t)for(;n&&1==n.nodeType;){if(t(n))return n;n=n.parentNode}else for(;n&&1==n.nodeType;){var r=!0;for(var a in t)"class"==a?this.hasClass(n,t[a])||(r=!1):n.getAttribute(a)!=t[a]&&(r=!1);if(r)return n;n=n.parentNode}return n},cancelEvent:function(e){e.preventDefault(),e.stopPropagation()},getBaseHref:function(){var e=document.getElementsByTagName("base");return 0!==e.length?e[0].href:""},getContextPath:function(){for(var e=document.getElementsByName("head")[0].getElementsByTagName("meta"),t=0;t<e.length;t++)if("contextPath"===e[t].name)return e[t].content?e[t].content:"/.";return"/."},isHtml5:function(){if(null==this._html5)try{var e=document.createElement("video");this._html5="undefined"!=typeof e.canPlayType&&""!=e.canPlayType("video/mp4")}catch(t){this._html5=!1}return this._html5},parseJSON:function(e,t){return JSON.parse(e,t)},formatJSON:function(e,t){return JSON.stringify(e,t)},parseXML:function(e,t){return(new DOMParser).parseFromString(e,t||"application/xml")},formatXML:function(e){return(new XMLSerializer).serializeToString(e)},getElementByTagNameId:function(e,t,n){for(var r=e.getElementsByTagName(t),a=0;a<r.length;a++)if(n==r[a].id)return r[a];return null},getElementsByTagName:function(e,t){return this.concat([],e.getElementsByTagName(t))},getElementsByTagNameClassName:function(e,t,n){var r=[];if(!e||!n)return r;for(var a=n.split(" "),o=e.getElementsByTagName(t),i=0;i<o.length;i++){var s=o[i].className;if(s)for(var l=0;l<a.length;l++){n=a[l];var c=s.indexOf(n);-1!=c&&(0!==c&&" "!=s.charAt(c-1)||c+n.length!=s.length&&" "!=s.charAt(c+n.length)||r.push(o[i]))}}return r},recycleChild:function(e){if(!e||this.isW3C)return e;var t=document.getElementById("recycleBin");if(!t)return e;for(var n=e.getElementsByTagName("iframe"),r=0;r<n.length;r++)n[r].onload="";return t.appendChild(e),t.innerHTML="",e},removeChild:function(e){return this.recycleChild(e.parentNode.removeChild(e))},replaceChild:function(e,t,n){return this.recycleChild(e.replaceChild(t,n))},replaceTextDataAsArrayOrNull:function(e,t){var n=null;if(!e||!e.length)return n;var r=0,a=e.indexOf("{");if(-1==a)return n;for(n=[];-1!=a;a=e.indexOf("{",r))if(n.push(e.substring(r,a)),r=a+1,a=e.indexOf("}",r),-1!=a){var o=e.substring(r,a),i=this.getProperty(t,o);null!=i?n.push(i):n.push(e.substring(r-1,a+1)),r=a+1}else r=e.length;return n.length&&n.push(e.substring(r,e.length)),n},replaceNodeData:function(e,t){for(var n,r=[e],a=r.pop();null!=a;a=r.pop()){var o=a.attributes;if(o)for(var i=0;i<o.length;i++){var s=o[i],l=s.nodeName,c=s.nodeValue;0===l.lastIndexOf("data--",6)?(l=l.substring(6),a.removeAttribute(s.nodeName),n=this.replaceTextDataAsArrayOrNull(c,t),null!=n&&a.setAttribute(l,n.join(""))):(n=this.replaceTextDataAsArrayOrNull(c,t),null!=n&&(s.nodeValue=n.join("")))}for(var u=a.childNodes,i=0;i<u.length;i++){var h=u[i];switch(h.nodeType){case 1:r[r.length]=h;case 3:case 4:n=this.replaceTextDataAsArrayOrNull(h.nodeValue,t),null!=n&&(h.nodeValue=n.join(""))}}}},cloneNodeByCreateElement:function(e,t,n){for(var r=e.createElement(t.nodeName),a=0;a<t.attributes.length;a++){var o=t.attributes[a].name;switch(o){case"class":o="className"}r[o]=t.attributes[a].value}return n&&t.innerHTML&&(r.innerHTML=t.innerHTML),r},cloneTemplateNode:function(e,t){var n=e.cloneNode(!0);return n.id=t?t:"",n.style.display="",n},importNode:function(e,t){var n,r,a=document.getElementById("recycleBin"),o=t.nodeName.toLowerCase();if("importNode"in e&&!("documentMode"in e&&9==e.documentMode))return n=e.createElement("link"===o||"style"===o||"script"===o?"head":"div"),"script"===o||"style"===o?n.appendChild(this.cloneNodeByCreateElement(e,t,!0)):n.appendChild(e.importNode(t,!0)),r=n.firstChild,n.removeChild(r),a&&a.appendChild(n),r;if("link"===o||"style"===o||"script"===o){n=this.cloneNodeByCreateElement(e,t);var i=t.xml,s=i.indexOf(">");if(s+1<i.length){var l=i.substring(s+1,i.lastIndexOf("<"));l>""&&("style"===o?n.styleSheet.cssText=l:"script"===o&&(n.text=l))}return n}return n=e.createElement("div"),n.innerHTML=t.xml,r=n.firstChild,n.removeChild(r),a&&a.appendChild(n),r},importElementsReplaceById:function(e,t,n){var r=[],a=null;a={count:0,callbackFn:null,check:function(){if(console.logEnabled&&console.log("scriptTracker.check count "+this.count),this.count<1&&this.callbackFn){try{this.callbackFn()}catch(e){var t="scriptTracker.callbackFn: "+String(e);console.error(t),alert(t)}this.callbackFn=null}},load:function(e){this.count++,e.onload=function(e){a.onload(e)},e.onreadystatechange=function(e){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||a.onload(e)},console.logEnabled&&console.log("scriptTracker.load count "+this.count)},onload:function(e){if(e){var t=akme.getEventElement(e);t.onload=null,t.onreadystatechange=null}this.count--,this.check()}};for(var o=[t],i=o.pop();null!=i;i=o.pop())for(var s=i.childNodes,l=0;l<s.length;l++){var c=s[l];if(1==c.nodeType){var u=c.getAttribute("id")>""?e.getElementById(c.getAttribute("id")):null;if(u){var h=this.importNode(e,c),f=h.nodeName.toLowerCase(),d="script"===f?h:null,p=d?[d]:h.getElementsByTagName("script");if(p&&p.length>0)for(var g=0;g<p.length;g++){var m=p[g],y=this.cloneNodeByCreateElement(e,m,!1);a.load(y),m.text>""&&(y.text=m.text),d?h=y:akme.replaceChild(m.parentNode,y,m)}akme.replaceChild(u.parentNode,h,u),r[r.length]=h}else o[o.length]=c}}return n&&(a.callbackFn=n),a.check(),r},importNodeAppendChild:function(e,t){var n;e.ownerDocument?n=e.ownerDocument:(n=e,e=n.getElementsByTagName("body")[0]);var r=this.importNode(n,t);return e.appendChild(r),r},toggleDisplay:function(e){e.style.display="none"!=e.style.display?"none":""},getAttributes:function(e,t){var n=e.attributes;t=t||{};for(var r=0;r<n.length;r++)t[n[r].name]=e.getAttribute(n[r].name);return t},setAttributes:function(e,t){for(var n in t)e.setAttribute(n,t[n]);return e}}),akme.xhr||(akme.xhr={DATE_1970:"Thu, 01 Jan 1970 00:00:00 GMT",HTTP_OK:200,HTTP_NO_CONTENT:204,HTTP_NOT_MODIFIED:304,CONTENT_TYPE:"Content-Type",CONTENT_BINARY:{"Content-Type":"application/octet-stream"},CONTENT_TEXT:{"Content-Type":"text/plain"},CONTENT_URLENCODED:{"Content-Type":"application/x-www-form-urlencoded"},CONTENT_HTML:{"Content-Type":"text/html"},CONTENT_XHTML:{"Content-Type":"application/xhtml+xml"},CONTENT_XML:{"Content-Type":"text/xml"},CONTENT_JSON:{"Content-Type":"application/json"},NO_CACHE_HEADER_MAP:{Pragma:"no-cache","Cache-Control":"no-cache, no-store"},PRIVATE_CACHE_HEADER_MAP:{Pragma:"private","Cache-Control":"private"},PRIVATE_VALID_CACHE_HEADER_MAP:{Pragma:"private","Cache-Control":"private, must-revalidate"},PUBLIC_CACHE_HEADER_MAP:{Pragma:"public","Cache-Control":"public"},PUBLIC_VALID_CACHE_HEADER_MAP:{Pragma:"public","Cache-Control":"public, must-revalidate"},FUTURE_CACHE_HEADER_MAP:{Pragma:"public","Cache-Control":"public, max-age=900"},encodeMap:function(e){var t=[];if(!e)return"";for(var n in e){var r=e[n];if(r&&r.constructor===Array)for(var a=0;a<r.length;a++)t.push(encodeURIComponent(n)+"="+encodeURIComponent(r[a]));else t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}return t.join("&")},decodeUrlEncoded:function(e){var t={};if("undefined"==typeof e||null===e)return t;for(var n=String(e).split("&"),r=0;r<n.length;r++){var a=n[r].split("=");t[decodeURIComponent(a[0])]=a.length>1?decodeURIComponent(a[1]):""}return t},open:function(e,t,n){var r=new XMLHttpRequest;return r.open(e,t,0!=n),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r},getXML:function(e){var t=this.open("GET",e,!1);return t.send(null),this.getResponseXML(t)},getJSON:function(e){var t=this.open("GET",e,!1);return t.send(null),this.getResponseJSON(t)},getResponseContentType:function(e){return e.contentType?e.contentType||"":e.getResponseHeader("Content-Type")||""},getStatus:function(e){return e.status&&1223==e.status?204:e.status},getResponseXML:function(e){var t,n=!(!e.responseXML||!e.responseXML.documentElement),r=this.getResponseContentType(e);return t=e.responseXML&&!n&&"ActiveXObject"in window&&"application/xhtml+xml"==r?(new DOMParser).parseFromString(e.responseText,r):e.responseXML,"parsererror"===t.documentElement.nodeName&&(t=null),t},getResponseJSON:function(e,t){return JSON.parse(e.responseText,t)},formatHttpHeaderName:function(e){for(var t=e.split("-"),n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].substring(1);return t.join("-")},fixHttpHeaderNames:function(e,t){for(var n=0;n<t.length;n++)t[n]=t[n].toLowerCase();for(var r in e)if(-1!=Array.indexOf(t,r.toLowerCase())){var a=this.formatHttpHeaderName(r);a!=r&&(e[a]=e[r],delete e[r])}},parseHeaders:function(e){for(var t={},n=0,r=e.indexOf("\n");-1!=r;n=r+1,r=e.indexOf("\n",n)){var a=e.indexOf(": ",n);-1!=a&&(t[this.formatHttpHeaderName(e.substring(n,a))]=e.substring(a+2,r).split("\r")[0])}return t},callAsync:function(e,t,n,r,a){var o=new XMLHttpRequest;return this.callAsyncXHR(o,e,t,n,r,a),o},callAsyncXHR:function(e,t,n,r,a,o){var i=this;e.open(t,n,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var s in r){var l=this.formatHttpHeaderName(s);e.setRequestHeader(l,r[s]),l!=s&&(r[l]=r[s],delete r[s])}if(r&&!("string"==typeof a||a instanceof String)){var c=r["Content-Type"];/json;|json$/.test(c)?a=akme.formatJSON(a):/xml;|xml$/.test(c)&&(a=akme.formatXML(a))}e.onreadystatechange=function(){var e=this;if(4===e.readyState){var t=i.parseHeaders(e.getAllResponseHeaders());t.status=i.getStatus(e),t.statusText=e.statusText;var n,r=t["Content-Type"];try{n=/json;|json$/.test(r)?i.getResponseJSON(e):/xml;|xml$/.test(r)?i.getResponseXML(e):e.responseText}catch(a){t.status=500,t.statusText=String(a),n=e.responseText}akme.handleEvent(o,t,n),i=e=o=null}},"undefined"!=typeof a?e.send(a):e.send()},callPromise:function(e,t,n,r){var a=new XMLHttpRequest;
return this.callPromiseXHR(a,e,t,n,r)},callPromiseXHR:function(e,t,n,r,a){function o(o,s){i.callAsyncXHR(e,t,n,r,a,function(e,t){void 0!==t&&(e.content=t),e.status>=400?s(e):o(e)})}var i=this,s=new akme.core.Promise(o);return s}}),akme.cookieStorage=akme.cookieStorage||{name:"akme.cookieStorage",getItem:function(e){var t,n,r,a,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(n=o[t].indexOf("="),r=o[t].substring(0,n),a=o[t].substring(n+1),r=r.replace(/^\s+|\s+$/g,""),r==e)return unescape(a)},setItem:function(e,t,n,r){var a=new Date;a.setDate(a.getDate()+(n?n:0)),document.cookie=e+"="+escape(t)+(n?"; expires="+a.toUTCString():"")+(r?"; path="+r:"")},removeItem:function(e,t){document.cookie=e+"=; expires=0"+(t?"; path="+t:"")}},akme.core.MessageBroker||(akme.core.MessageBroker=akme.extendClass(akme.copyAll(function(e){this.id=e.id,this.allowOrigins=e.allowOrigins,this.callbackKey=0,this.callbackMap={},this.callbackTime={}},{CLASS:"akme.core.MessageBroker"}),{destroy:function(){for(var e in this.callbackMap)delete this.callbackMap[e];for(var e in this.callbackTime)delete this.callbackTime[e]},newCallbackKey:function(){var e=this.callbackKey=(this.callbackKey+1)%65535;return e},deleteCallbackKey:function(e){delete this.callbackMap[e],delete this.callbackTime[e]},callAsync:function(e,t,n){var r;e instanceof Element?(r=arguments[0],e=arguments[1],t=arguments[2],n=arguments[3]):r=document.getElementById(this.id);var a=this.newCallbackKey();e.callback=this.id+".callbackMap."+a;var o=this;o.callbackMap[a]=function(e,t){o.deleteCallbackKey(a),akme.handleEvent(n,e,t),o=a=n=null},o.callbackTime[a]=(new Date).getTime(),akme.xhr.fixHttpHeaderNames(e,["Content-Type"]),/xml;|xml$/.test(e["Content-Type"])&&!(t instanceof String)&&t instanceof Object?t=akme.formatXML(t):/json;|json$/.test(e["Content-Type"])&&!(t instanceof String)&&t instanceof Object&&(t=akme.formatJSON(t));var i=this.formatMessage(e,t),s=r.src.substring(0,r.src.indexOf("/",8));return r.contentWindow.postMessage(i,s),e.callback},submitAsync:function(e,t){var n={call:"SubmitRequest"},r=this.newCallbackKey();n.callback=this.id+".callbackMap."+r;var a=this;return a.callbackMap[r]=function(e,n){a.deleteCallbackKey(r),akme.handleEvent(t,e,n),a=r=t=null},a.callbackTime[r]=(new Date).getTime(),a[n.call](n,{type:"submit",target:e}),n.callback},handleEvent:function(e){var t=!0,n=-1!==location.hostname.indexOf(".")||location.hostname.indexOf(".local",location.hostname.length-6)==location.hostname.length-6;(e.origin==location.href.substring(0,location.href.indexOf("/",8))||!n&&e.origin.substring(e.origin.indexOf("/"))==location.href.substring(location.href.indexOf("/"),location.href.indexOf("/",8)))&&(t=!1);for(var r=0;r<this.allowOrigins.length;r++)this.allowOrigins[r]==e.origin&&(t=!1);var a=this.parseMessage(e.data);if(t)return void console.error(this.id+" at "+location.href+" DENY "+a.call+" from "+e.origin);var o=a.headers.callback;!a.headers.call||"function"!=typeof this[a.headers.call]||o&&o.substring(0,o.lastIndexOf(".callbackMap."))!=this.id||this[a.headers.call].call(this,a.headers,a.content,e)},formatMessage:function(e,t){var n=[];n[n.length]="call: "+e.call;for(var r in e)"call"!=r&&"undefined"!=typeof e[r]&&(n[n.length]=r+": "+e[r]);return n.join("\r\n")+"\r\n\r\n"+(t?t:"")},parseMessage:function(e){for(var t="",n={},r=0,a=e.indexOf("\n");-1!=a;r=a+1,a=e.indexOf("\n",r)){if(r+1>=a){t=e.substring(a+1);break}var o=e.indexOf(": ",r);n[e.substring(r,o)]=e.substring(o+2,a).split("\r")[0]}return{headers:n,content:t}},XMLHttpRequest:function(e,t,n){var r=akme.xhr.open(e.method,e.url,!0),a=e.callback,o=n.source,i=n.origin;if(delete e.call,delete e.callback,delete e.method,delete e.url,e)for(var s in e)r.setRequestHeader(s,e[s]);var l=this;r.onreadystatechange=function(){var e=this;if(4===e.readyState){var t={call:"XMLHttpResponse",readyState:e.readyState,status:e.status?e.status:0,statusText:e.statusText?e.statusText:""};a&&(t.callback=a);var r=e.getAllResponseHeaders();r&&akme.copyAll(t,akme.xhr.parseHeaders(r));var s=e.responseText?e.responseText:"";if(/xml;|xml$/.test(t["Content-Type"])||/html;|html$/.test(t["Content-Type"])){var c=s.indexOf("<!DOCTYPE "),u=-1!==c?s.indexOf(">",c+10):-1;-1!==u&&(-1!==s.lastIndexOf(" SYSTEM ",u)||document.documentMode&&document.documentMode<9&&-1===s.lastIndexOf(" PUBLIC ",u))&&(s=s.substring(0,c)+s.substring(s.indexOf("<",u+1)))}var h=l.formatMessage(t,s);window.console&&console.log(l.id+" "+location.protocol+"//"+location.host+" XMLHttpRequest postMessage back "+String(n.origin||i)),n.source?n.source.postMessage(h,n.origin):o.postMessage(h,i),l=e=a=n=o=i=null}},r.send(t||null)},XMLHttpResponse:function(e,t){var n=akme.getProperty(window,e.callback);if(!n||200!=e.status&&204!=e.status&&304!=e.status)console.logEnabled&&console.log(akme.formatJSON(e)+"\n\n"+t),n&&akme.handleEvent(n,e,t);else if(/xml;|xml$/.test(e["Content-Type"])){var r=t;try{r=akme.parseXML(t,"application/xml")}catch(a){e.status=500,e.statusText=String(a)}n&&"object"==typeof r&&"childNodes"in r&&-1!==r.firstChild.nodeName.lastIndexOf(":Envelope")&&-1!==r.firstChild.lastChild.nodeName.lastIndexOf(":Body")&&(r=r.firstChild.lastChild.firstChild),akme.handleEvent(n,e,r)}else if(/json;|json$/.test(e["Content-Type"])){var o=t;try{o=akme.parseJSON(t)}catch(a){e.status=500,e.statusText=String(a)}akme.handleEvent(n,e,o)}else akme.handleEvent(n,e,t)},StorageRequest:function(e,t,n){var r=akme.localStorage,a=e.callback,o=n.source,i=n.origin;t?"importAll"===e.method?r[e.method](akme.parseJSON(t)):t=r[e.method](e.type,e.key,t):t=r[e.method](e.type,e.key),"object"==typeof t&&(t=akme.formatJSON(t));var s=e;e={call:"StorageResponse",method:s.method,type:s.type,key:s.key},a&&(e.callback=a);var l=this.formatMessage(e,t);window.console&&console.log(this.id+" "+location.protocol+"//"+location.host+" StorageRequest postMessage back "+String(n.origin||i)),n.source?n.source.postMessage(l,n.origin):o.postMessage(l,i)},StorageResponse:function(e,t){var n=akme.getProperty(window,e.callback);return n?void akme.handleEvent(n,e,akme.parseJSON(t)):void(console.logEnabled&&console.log(akme.formatJSON(e)+"\n\n"+t))},SubmitRequest:function(e,t){function n(){r.SubmitResponse({call:"SubmitResponse",callback:e.callback},null)}var r=this,a=t.target,o=a.nodeName.toLowerCase();if("form"==o){if("function"==typeof a.onsubmit&&!a.onsubmit(t))return n();var i=a.elements.callback;return i||(i=a.ownerDocument.createElement("input"),i.setAttribute("type","hidden"),i.setAttribute("name","callback"),a.appendChild(i)),i.value=e.callback,void a.submit()}return console.logEnabled&&console.log("submitAsync called with unknown Element ",a),n()},SubmitResponse:function(e,t){var n=akme.getProperty(window,e.callback);n?(/json;|json$/.test(e["Content-Type"])&&t&&(t=akme.parseJSON(t)),akme.handleEvent(n,e,t)):console.logEnabled&&console.log(akme.formatJSON(e)+"\n\n"+t)}})),akme.copy(akme,{getParentElementByTagNameClassName:function(e,t,n){if(!e||!t||!n)return null;for(var r=t.toUpperCase(),a=e,o=n.split(" ");a&&a.parentNode&&a!=a.parentNode;)if(a=a.parentNode,a.nodeName==r){var i=a.className;if(!i)continue;for(var s=0;s<o.length;s++){n=o[s];var l=i.indexOf(n);if(-1!==l&&!(0!==l&&" "!=i.charAt(l-1)||l+n.length!=i.length&&" "!=i.charAt(l+n.length)))return a}}},toggleClass:function(e,t){for(var n=e.className,r=[].concat(n.split(" ")),a=[],o=0;o<r.length;o++)t!=r[o]&&(a[a.length]=r[o]);a.length==r.length&&(a[a.length]=t),e.className=a.join(" ")},hasClass:function(e,t){for(var n=e.className,r=[].concat(n.split(" ")),a=0;a<r.length;a++)if(t==r[a])return!0;return!1},xml2js:function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0)for(var n=0;n<e.attributes.length;n++)t[e.attributes[n].nodeName]=e.attributes[n].nodeValue}else 3==e.nodeType&&(t.$=e.nodeValue);if(e.hasChildNodes())for(var r,a,o=0;o<e.childNodes.length;o++)r=e.childNodes[o].nodeName,"undefined"==typeof t[r]?t[r]=this.xml2js(e.childNodes[o]):(a=t[r],"undefined"==typeof a.length&&(a=[a]),"object"==typeof a&&(a[a.length]=this.xml2js(e.childNodes[o])),t[r]=a);return t},xml2jsReviver:function(e,t){if("string"==typeof t&&(-1!=e.indexOf("Date",e.length-4)||-1!=e.indexOf("Datetime",e.length-8)||-1!=e.indexOf("DateTime",e.length-8))){var n=/^(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z?$/.exec(t);if(n&&"Z"===t.charAt(t.length-1))return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6]));if(n)return new Date(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])}return t},timer:{items:[],clear:function(){this.items=[]},add:function(e){this.items.push([e,new Date])},getName:function(e){return this.items[e][0]},getValue:function(e){return this.items[e][1]},getDiff:function(e){return this.items[e][1]-this.items[e-1][1]},getDiffOverall:function(){return this.items[this.items.length-1][1]-this.items[0][1]},appendInfoToElement:function(e){for(var t=this.items,n=[],r=0;r<t.length;r++)n.push((t[r][0]?t[r][0]+" : ":"")+(0===r?t[r][1]:t[r][1]-t[r-1][1]));e.appendChild(document.createTextNode("{"+n.join(", ")+"}"))}}}),akme.form||(akme.form={getFormElements:function(e){for(var t=[],n=["button","input","select","textarea"],r=0;r<n.length;r++)for(var a=e.getElementsByTagName(n[r]),o=0;o<a.length;o++)t[t.length]=a[o];return t},cloneFormElementValues:function(e,t){for(var n=this.getFormElements(e),r=this.getFormElements(t),a=0;a<n.length&&a<r.length;a++){var o=n[a],i=r[a];if(o.checked)i.checked=!0;else if(o.selectedIndex>=-1){if(i.selectedIndex=o.selectedIndex,o.multiple)for(var s=0;s<o.options.length;s++)o.options[s].selected&&(i.options[s].selected=!0)}else o.value&&(i.value=o.value)}},getValue:function(e){var t=e instanceof NodeList?e[0]:e,n=t.nodeName.toLowerCase();if("select"==n)return e.options[e.selectedIndex].value;if("input"!=n||"radio"!=t.type&&"checkbox"!=t.type)return e.value;if("length"in t){for(var r=0;r<t.length;r++)if(t[r].checked)return t[r].value;return""}return e.checked?e.value:""},setValue:function(e,t){var n=e instanceof NodeList?e[0]:e,r=n.nodeName.toLowerCase();if("select"==r)for(var a=0;a<e.options.length;a++){var o=e.options[a];o.selected=o.value==t,o.selected&&(e.selectedIndex=a)}else if("input"!=r||"radio"!=n.type&&"checkbox"!=n.type)e.value=t;else if("length"in n)for(var a=0;a<n.length;a++){var i=n[a];i.checked=t==i.value}else e.checked=t==e.value},setChecked:function(e,t){this.setValue(e,t)},setSelected:function(e,t){this.setValue(e,t)},getIntoMap:function(e,t){t=t||{};for(var n=0;n<e.elements.length;n++){var r=e.elements[n];if("name"in r&&0!==r.name.length){var a=this.getValue(r),o=-1;if(r.name in t){var i=t[r.name];i instanceof Array?(o=i.length,i[i.length]=a):t[r.name]=[i,a]}else t[r.name]=a;console.logEnabled&&console.log("get ",e.name,-1!=o?r.name+"["+n+"]":r.name,a)}}return t},setFromMap:function(e,t){for(var n in t){var r=e.elements[n];if(r){var a=t[n],o=a instanceof Array;o||(a=[a]),r instanceof NodeList||(r=[r]);for(var i=0;i<a.length&&i<r.length;i++)this.setValue(r[i],a[i]),console.logEnabled&&console.log("set ",e.name,o?r[i].name+"["+i+"]":r.name,o?r[i].value:r.value)}}return e}}),akme.selectHelper=akme.selectHelper||{timeout:1500,timestamp:0,text:"",elem:null,focus:function(e,t){return this.text="",this.elem=e,this.timestamp=0,!0},keypress:function(e){if(e||(e=window.event),!e)return!1;var t=e.target?e.target:e.srcElement;if(!t)return!1;var n=e.keyCode?e.keyCode:e.which,r=(new Date).getTime();return 0===this.timestamp?this.timestamp=r:(this.elem!==t||r-this.timestamp>this.timeout)&&(this.text="",this.timestamp=r),this.elem=t,(32==n||n>=48)&&!String.fromCharCode(n).match(akme.PRINTABLE_EXCLUDE_REGEXP)?(32!=n&&(this.text+=String.fromCharCode(n)),this.find(t),e.cancelable&&e.preventDefault(),e.bubbles&&e.stopPropagation(),!1):(this.text="",this.timestamp=0,!0)},find:function(e){for(var t=e.selectedIndex>0?e.selectedIndex:0,n=t>0?e.options[t].text.toUpperCase()<this.text.toUpperCase():!1,r=t>0&&n?t:0,a=t>0&&!n?t:e.options.length-1;a>=r;)t=Math.floor(r+(a-r)/2),n=e.options[t].text.toUpperCase()<this.text.toUpperCase(),n?r=t+1:a=t-1;e.selectedIndex=n&&t+1<e.options.length?t+1:t}},akme.copy(akme.xhr,{getXmlHttpResponse:function(e,t,n,r){var a=new XMLHttpRequest,o=[0,""];try{if(r?a.open("GET",e+"?"+this.encodeMap(r),!1):a.open("GET",e,!1),n)for(var i in n)a.setRequestHeader(i,n[i]);a.send(""),o[0]=a.status,!t||a.status&&a.status!=this.HTTP_OK?o[1]=a.statusText:o[1]=a.responseText}catch(s){throw o=[s.number,s.description],s}finally{a=null}return o},postXmlHttp:function(e,t,n,r){var a=new XMLHttpRequest,o=[0,""];try{a.open("POST",e,!1);var i=!1;if(n)for(var s in n)a.setRequestHeader(s,n[s]),"content-type"==s.toLowerCase()&&(i=!0);i||a.setRequestHeader(this.CONTENT_TYPE,this.CONTENT_XML[this.CONTENT_TYPE]),a.send(r),o[0]=a.status,!t||a.status&&a.status!=this.HTTP_OK?o[1]=a.statusText:o[1]=a.responseText}catch(l){o=[l.number,l.description]}finally{a=null}return o}}),akme._callbasep||(akme._callbasep={_tag:"",_lock:[!0],_count:0,timeout:9e3,cleanup:function(e,t,n){t||(t=document);var r=t.getElementById(e);return!r||n&&r.title!=n?null:r.parentNode.removeChild(r)},call:function(e,t,n,r){r||(r=document);var a=this._lock.pop()===!0;if(!a||!t||r.getElementById(t))return a&&this._lock.push(!0),!1;var o=t+"_"+ ++this._count,i=r.createElement(this._tag);i.id=t,i.className=this._tag+"p",i.title=o,i.src=e,"iframe"==this._tag&&(i.onload=function(){setTimeout(t+'(document.getElementById("'+t+'").contentDocument)',0)}),r.body.appendChild(i),a&&this._lock.push(!0);var s=this;return setTimeout(function(){var e=s.cleanup(t,r,o);e&&n&&n(e)},this.timeout),!0}}),akme.iframep||(akme.iframep=akme.copy(akme.clone(akme._callbasep),{_tag:"iframe"})),akme.scriptp||(akme.scriptp=akme.copy(akme.clone(akme._callbasep),{_tag:"script"})),akme.hsv2rgb||(akme.hsv2rgb=function(e){var t,n,r,a,o,i,s,l;if(0===e[2])return[0,0,0];var c=e[0]%360,u=e[1]/100,h=e[2]/100;switch(c/=60,a=Math.floor(c),o=c-a,i=h*(1-u),s=h*(1-u*o),l=h*(1-u*(1-o)),a){case 0:t=h,n=l,r=i;break;case 1:t=s,n=h,r=i;break;case 2:t=i,n=h,r=l;break;case 3:t=i,n=s,r=h;break;case 4:t=l,n=i,r=h;break;case 5:t=h,n=i,r=s}return[Math.floor(255*t),Math.floor(255*n),Math.floor(255*r)]}),akme.rgb2hsv||(akme.rgb2hsv=function(e){var t,n,r,a,o,i,s=e[0]/255,l=e[1]/255,c=e[2]/255;return t=Math.min(Math.min(s,l),c),i=Math.max(Math.max(s,l),c),t==i?[void 0,0,100*i]:(n=s==t?l-c:l==t?c-s:s-l,r=s==t?3:l==t?5:1,a=Math.floor(60*(r-n/(i-t)))%360,o=Math.floor((i-t)/i*100),i=Math.floor(100*i),[a,o,i])}),akme.rgb2hex||(akme.rgb2hex=function(e){return this.toHexByte(e[0])+this.toHexByte(e[1])+this.toHexByte(e[2])}),akme.toHexByte||(akme.toHexByte=function(e){return null==e?"00":(e=parseInt(e),0===e||isNaN(e)?"00":(e=Math.max(0,e),e=Math.min(e,255),e=Math.round(e),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)))}),function(e,t){function n(t){e.core.EventSource.apply(this),this.getStorage=function(){return t}}function r(e,t){var n=this.getStorage().getItem(e+p+t);return this.doEvent({type:"getItem",keyType:e,key:t,value:n}),n}function a(e,t){var n=akme.parseJSON(this.getStorage().getItem(e+p+t));return this.doEvent({type:"getItem",keyType:e,key:t,value:n}),n}function o(e,t,n){this.getStorage().setItem(e+p+t,n),this.doEvent({type:"setItem",keyType:e,key:t,value:n})}function i(e,t,n){this.getStorage().setItem(e+p+t,akme.formatJSON(n)),this.doEvent({type:"setItem",keyType:e,key:t,value:n})}function s(e,t){this.getStorage().removeItem(e+p+t),this.doEvent({type:"removeItem",keyType:e,key:t})}function l(e){for(var t=this.getStorage(),n=e+p,r=0,a={},o=0;o<t.length;o++){var i=t.key(o);0===i.lastIndexOf(n,n.length)&&(a[i.substring(n.length)]=t.getItem(i),r++)}return this.doEvent({type:"getAll",keyType:e,count:r,result:a}),a}function c(e,t){var n=this.getStorage(),r=0;for(var a in t){var o=e+p+a;n.setItem(o,t[a]),r++}this.doEvent({type:"setAll",keyType:e,count:r,map:t})}function u(e){for(var t=this.getStorage(),n=e+p,r=0,a=t.length-1;a>=0;a--){var o=t.key(a);0===o.lastIndexOf(n,n.length)&&(t.removeItem(o),r++)}this.doEvent({type:"removeAll",keyType:e,count:r})}function h(){for(var e=this.getStorage(),t={},n=0,r=0;r<e.length;r++)t[e.key(r)]=e.getItem(e.key(r)),n++;return this.doEvent({type:"exportAll",count:n,result:t}),t}function f(e){var t=this.getStorage(),n=0;for(var r in e)t.setItem(r,e[r]),n++;this.doEvent({type:"importAll",count:n})}function d(){var e=this.size();this.getStorage().clear(),this.doEvent({type:"clear",count:e})}if(!e.getProperty(e.THIS,t)){var p=":";e.extendClass(e.copyAll(n,{CLASS:t}),{getItem:r,getItemJSON:a,setItem:o,setItemJSON:i,removeItem:s,getAll:l,setAll:c,removeAll:u,exportAll:h,importAll:f,clear:d}),e.setProperty(e.THIS,t,n)}}(akme,"akme.dom.Storage"),akme.localStorage||(akme.localStorage=new akme.dom.Storage({name:"localStorage",length:"undefined"!=typeof localStorage?localStorage.length:0,size:function(){return this.length=localStorage.length,this.length},key:function(e){return localStorage.key(e)},getItem:function(e){return localStorage.getItem(e)},setItem:function(e,t){localStorage.setItem(e,t),this.length=localStorage.length},removeItem:function(e){localStorage.removeItem(e),this.length=localStorage.length},clear:function(){localStorage.clear(),this.length=localStorage.length}})),akme.sessionStorage||(akme.sessionStorage=new akme.dom.Storage({name:"sessionStorage",length:"undefined"!=typeof sessionStorage?sessionStorage.length:0,size:function(){return this.length=sessionStorage.length,this.length},key:function(e){return sessionStorage.key(e)},getItem:function(e){return sessionStorage.getItem(e)},setItem:function(e,t){sessionStorage.setItem(e,t),this.length=sessionStorage.length},removeItem:function(e){sessionStorage.removeItem(e),this.length=sessionStorage.length},clear:function(){sessionStorage.clear(),this.length=sessionStorage.length}})),function(e,t){function n(t,n){this.name=t,this.url=n,this.cacheMap={};var r=e.getProperty(e.THIS,t);"function"==typeof r&&(this.dataConstructor=r),e.core.EventSource.apply(this)}function r(e,t){return"jsonReviver"in this.constructor?this.constructor.jsonReviver.call(this,e,t):t}function a(e,t){return"jsonReplacer"in this.constructor?this.constructor.jsonReplacer.call(this,e,t):t}function o(e,t,n,r,a){var o=new XMLHttpRequest;return i(o,e,t,n,r,a),o}function i(t,n,r,a,o,i){t.open(n,r,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var s in a)t.setRequestHeader(s,a[s]);t.onreadystatechange=function(){var t=this;4==t.readyState&&e.handleEvent(i,{type:"readystatechange",target:t})},"undefined"!=typeof o?t.send(o):t.send()}function s(e,t){e||(e={}),e.status=t.status,e.statusText=t.statusText;for(var n in{"Cache-Control":1,"Content-Encoding":1,"Content-Length":1,"Content-Type":1,Date:1,ETag:1,Expires:1,"Last-Modified":1,Pragma:1,Server:1,Vary:1,Warning:1}){var r=t.getResponseHeader(n);r&&(e[n]=r)}return e}function l(){this.cacheMap?this.cacheMap={}:e.sessionStorage.removeAll(this.name)}function c(e){var t=this.find(e);return 0===t.length?t[0]:null}function u(t,n,r){function a(n){var a=n.target,o=a.getResponseHeader("ETag"),c={id:t,rev:o?o.replace(/^"|"$/g,""):null};s(c,a),console.logEnabled&&console.log("HEAD "+l,a.status,a.statusText,c.rev),i.doEvent({type:"info",keyType:i.name,key:t,info:c}),e.handleEvent(r,c,c),i=a=t=r=null}var i=this,l=i.url+"/"+encodeURIComponent(t),c=o("HEAD",l,{Accept:g},null,a);return c}function h(t,n,r){function a(a){var o=a.target,c=o.getResponseHeader("ETag"),u={id:t,rev:c?c.replace(/^"|"$/g,""):null};s(u,o),console.logEnabled&&console.log("COPY "+l,n,o.status,o.statusText,u.rev),i.doEvent({type:"info",keyType:i.name,key:t,newKey:n,info:u}),e.handleEvent(r,u,u),i=o=t=r=null}var i=this,l=i.url+"/"+encodeURIComponent(t),c=o("COPY",l,{Accept:g,Destination:n},null,a);return c}function f(t,n){function a(a){var o=a.target,c=e.xhr.getResponseContentType(o);console.logEnabled&&console.log("GET "+l,o.status,o.statusText,c);var u=s({},o),h=o.status<400&&c&&0===c.indexOf(g)?o.responseText:null;h?(this.cacheMap?this.cacheMap[t]=h:e.sessionStorage.setItem(i.name,t,h),h=e.parseJSON(h,r)):this.cacheMap?delete this.cacheMap[t]:e.sessionStorage.removeItem(i.name,t),i.dataConstructor&&h&&(h=new i.dataConstructor(h)),i.doEvent({type:"read",keyType:i.name,key:t,value:h,headers:u}),e.handleEvent(n,h,u),i=o=t=n=null}var i=this,l=i.url+"/"+encodeURIComponent(t),c=o("GET",l,{Accept:g},null,a);return c}function d(t,n,r){function i(o){var i=o.target,c=e.xhr.getResponseContentType(i);console.logEnabled&&console.log("PUT "+u,i.status,i.statusText,c);var h=s({},i),f=c&&0===c.indexOf(g)?e.parseJSON(i.responseText):i.responseText;f.ok&&f.rev&&(n._id=f.id,n._rev=f.rev,this.cacheMap?this.cacheMap[t]=n:e.sessionStorage.setItem(l.name,t,e.formatJSON(n,a))),l.doEvent({type:"write",keyType:l.name,key:t,value:n,headers:h}),e.handleEvent(r,f,h),l=i=t=n=r=null}var l=this,c=e.sessionStorage.getItemJSON(l.name,t);c&&c._id&&(n._id=c._id,n._rev=c._rev);var u=l.url+"/"+encodeURIComponent(t),h=o("PUT",u,{Accept:g,"Content-Type":g},"string"==typeof n?n:e.formatJSON(n,a),i);return h}function p(t,n,r){function a(e){var t=e.target;n=t.getResponseHeader("ETag"),n&&(n=n.replace(/^"|"$/g,"")),n||(n=""),o()}function o(){h=c.url+"/"+encodeURIComponent(t)+"?rev="+encodeURIComponent(n),i(u,"DELETE",h,{Accept:g},null,l)}function l(a){u=a.target;var o=e.xhr.getResponseContentType(u);console.logEnabled&&console.log("DELETE "+h,u.status,u.statusText,o);var i=s({},u),l=o&&0===o.indexOf(g)?e.parseJSON(u.responseText):u.responseText;l.ok&&l.rev&&(this.cacheMap?delete this.cacheMap[t]:e.sessionStorage.removeItem(c.name,t)),c.doEvent({type:"remove",keyType:c.name,key:t,headers:i}),e.handleEvent(r,l,i),c=u=h=t=n=r=null}var c=this,u=new XMLHttpRequest,h=null;return n?o():(h=c.url+"/"+encodeURIComponent(t),i(u,"HEAD",h,{Accept:g},null,a)),u}if(!e.getProperty(e.THIS,t)){var g="application/json";e.extendClass(e.copyAll(n,{CLASS:t}),e.copyAll(new e.core.Access,{clear:l,findOne:c,info:u,copy:h,read:f,write:d,remove:p})),e.setProperty(e.THIS,t,n)}}(akme,"akme.core.CouchAsyncAccess");
//# sourceMappingURL=../web/common/akme-core.min.js.map