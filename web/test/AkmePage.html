<!DOCTYPE html ><html xmlns='http://www.w3.org/1999/xhtml'><head>
<title>AkmePage</title>
<meta http-equiv='X-UA-Compatible' content='IE=edge' />
<style>
iframe.postMessage { display:inline; width:0; height:0; border:0; }
</style>
<script src='AkmeService.js'></script>
<script>/*<![CDATA[*/

// main page at user.mydomain.com

function callServiceFrame(msg) {
    var iframe = document.getElementById("ServiceFrame");
    var targetOrigin = iframe.src.substring(0, iframe.src.indexOf("/", 8));
    iframe.contentWindow.postMessage(msg, targetOrigin);
}

// message EventListener for callbacks
akme.onEvent(window, "message", function(messageEvent) { // ev.data, ev.origin, ev.source
    var source = messageEvent.source;
    var origin = messageEvent.origin;
    var allowOrigin = "http://localhost";
	if (allowOrigin !== origin) {
		alert("AkmePage deny "+ origin);
		return;
	}
	
    var outputText = document.forms[0].elements["outputText"];
    outputText.value = messageEvent.data;
});

/*]]>*/</script>
<head><body>
<iframe id="ServiceFrame" name="ServiceFrame" class="postMessage" frameborder="0" scrolling="no" src="AkmeFrame.html"></iframe>

AkmePage
<form name="" action="" onsubmit="return false;">
  <input type="text" name="inputText" value="Joe"/>
  <input type="button" name="goBtn" value="Go" onclick="callServiceFrame(this.form.elements['inputText'].value)"/>
  <input type="text" name="outputText" value=""/>
  <input type="reset" name="resetBtn" value="Clear"/>
</form>

</body></html>